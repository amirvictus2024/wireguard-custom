<!DOCTYPE html>
<html lang="fa">

<head>
    <meta charset="UTF-8">
    <title>پنل تولید کانفیگ وایرگارد</title>
    <style>
        /* سبک Dark Mode شبیه macOS */
        body {
            background-color: #1e1e1e;
            color: #f0f0f0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 40px;
            direction: rtl;
        }

        .container {
            background-color: #2c2c2c;
            max-width: 900px;
            margin: auto;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.6);
        }

        h1 {
            text-align: center;
            color: #f0f0f0;
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #ccc;
            cursor: pointer;
        }

        input,
        select,
        button,
        textarea {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #555;
            border-radius: 6px;
            box-sizing: border-box;
            font-size: 14px;
            background-color: #3c3c3c;
            color: #f0f0f0;
        }

        input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: #007aff;
            box-shadow: 0 0 4px rgba(0, 122, 255, 0.6);
        }

        button {
            background-color: #007aff;
            border: none;
            color: #fff;
            font-size: 14px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            border-radius: 4px;
        }

        button:hover {
            background-color: #005ecb;
        }

        .small-btn {
            width: auto;
            padding: 8px 12px;
            margin: 5px 0;
            font-size: 13px;
        }

        .list-box {
            border: 1px solid #555;
            padding: 10px;
            min-height: 40px;
            background-color: #333;
            border-radius: 6px;
            margin-bottom: 15px;
        }

        textarea {
            resize: vertical;
            min-height: 300px;
            background-color: #333;
            color: #f0f0f0;
        }

        /* کادر نمایش خروجی کلیدها */
        #keysDisplay {
            background-color: #2a2a2a;
            color: #00ff00;
            padding: 10px;
            border: 1px solid #007aff;
            border-radius: 6px;
            margin-top: 10px;
            word-wrap: break-word;
        }

        /* استایل کاندیدای پیش‌نمایش (بدون نیاز به چک‌باکس) */
        .candidate-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background-color: #444;
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #666;
            border-radius: 6px;
        }

        .candidate-text {
            font-weight: 500;
            color: #f0f0f0;
            flex: 1;
        }

        .candidate-actions {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .confirmCandidateBtn,
        .cancelCandidateBtn {
            background-color: #007aff;
            border: none;
            color: #fff;
            padding: 6px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
        }

        .cancelCandidateBtn {
            background-color: #ff3b30;
        }

        /* استایل آیتم‌های لیست (برای آدرس و DNS) */
        .list-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 6px 10px;
            background-color: #3c3c3c;
            border: 1px solid #555;
            border-radius: 4px;
            margin-bottom: 5px;
        }

        .list-item span {
            flex: 1;
        }

        .list-item button {
            background-color: transparent;
            border: none;
            color: #ff3b30;
            cursor: pointer;
            font-size: 16px;
        }

        /* استایل برای فیلدهای MTU و Keepalive */
        .custom-inputs {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .custom-inputs>div {
            flex: 1;
        }

        /* استایل Toggle Switch (checkbox-wrapper-3) برای تمام چک‌باکس‌ها */
        .checkbox-wrapper-3 input[type="checkbox"] {
            visibility: hidden;
            display: none;
        }

        .checkbox-wrapper-3 .toggle {
            position: relative;
            display: block;
            width: 40px;
            height: 20px;
            cursor: pointer;
            -webkit-tap-highlight-color: transparent;
            transform: translate3d(0, 0, 0);
        }

        .checkbox-wrapper-3 .toggle:before {
            content: "";
            position: relative;
            top: 3px;
            left: 3px;
            width: 34px;
            height: 14px;
            display: block;
            background: #9A9999;
            border-radius: 8px;
            transition: background 0.2s ease;
        }

        .checkbox-wrapper-3 .toggle span {
            position: absolute;
            top: 0;
            left: 0;
            width: 20px;
            height: 20px;
            display: block;
            background: white;
            border-radius: 10px;
            box-shadow: 0 3px 8px rgba(154, 153, 153, 0.5);
            transition: all 0.2s ease;
        }

        .checkbox-wrapper-3 .toggle span:before {
            content: "";
            position: absolute;
            display: block;
            margin: -18px;
            width: 56px;
            height: 56px;
            background: rgba(79, 46, 220, 0.5);
            border-radius: 50%;
            transform: scale(0);
            opacity: 1;
            pointer-events: none;
        }

        .checkbox-wrapper-3 input[type="checkbox"]:checked+.toggle:before {
            background: #947ADA;
        }

        .checkbox-wrapper-3 input[type="checkbox"]:checked+.toggle span {
            background: #4F2EDC;
            transform: translateX(20px);
            transition: all 0.2s cubic-bezier(0.8, 0.4, 0.3, 1.25), background 0.15s ease;
            box-shadow: 0 3px 8px rgba(79, 46, 220, 0.2);
        }

        .checkbox-wrapper-3 input[type="checkbox"]:checked+.toggle span:before {
            transform: scale(1);
            opacity: 0;
            transition: all 0.4s ease;
        }

        /* ریسپانسیو */
        @media (max-width: 600px) {
            .container {
                padding: 20px;
            }

            input,
            select,
            button,
            textarea {
                font-size: 12px;
                padding: 8px;
            }
        }
    </style>
    <!-- کتابخانه TweetNaCl جهت تولید کلیدها -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tweetnacl/1.0.3/nacl.min.js"></script>
    <!-- کتابخانه JSZip جهت تولید فایل زیپ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
</head>

<body>
    <div class="container">
        <h1>پنل تولید کانفیگ وایرگارد</h1>

        <!-- انتخاب کشور -->
        <div>
            <label for="location">انتخاب کشور:</label>
            <select id="location">
                <option value="SA">عربستان</option>
                <option value="UK">انگلستان</option>
                <option value="SE">سوئد</option>
                <option value="DE">آلمان</option>
            </select>
        </div>

        <!-- انتخاب پورت Endpoint -->
        <div>
            <label for="port">انتخاب پورت Endpoint:</label>
            <input type="number" id="port" placeholder="مثلاً 443 یا 1194 یا 53" value="443">
        </div>

        <!-- تنظیمات MTU و PersistentKeepalive -->
        <div class="custom-inputs">
            <div>
                <label for="mtu">MTU (اختیاری):</label>
                <input type="number" id="mtu" placeholder="مثلاً 1420">
            </div>
            <div>
                <label for="keepalive">PersistentKeepalive (اختیاری):</label>
                <input type="number" id="keepalive" placeholder="خالی = غیرفعال">
            </div>
        </div>

        <!-- انتخاب نوع Endpoint (فقط یکی قابل انتخاب است) -->
        <div>
            <label>انتخاب نوع Endpoint:</label>
            <div id="endpointTypeContainer">
                <div class="default-address-item">
                    <div class="checkbox-wrapper-3">
                        <input type="checkbox" id="endpointIPv4Check" checked>
                        <label for="endpointIPv4Check" class="toggle"><span></span></label>
                    </div>
                    <label for="endpointIPv4Check" class="inline">IPv4</label>
                </div>
                <div class="default-address-item">
                    <div class="checkbox-wrapper-3">
                        <input type="checkbox" id="endpointIPv6Check">
                        <label for="endpointIPv6Check" class="toggle"><span></span></label>
                    </div>
                    <label for="endpointIPv6Check" class="inline">IPv6</label>
                </div>
            </div>
        </div>

        <!-- دکمه تولید کلید (اجباری) -->
        <div>
            <button id="genKeys">تولید کلیدهای وایرگارد</button>
            <div id="keysDisplay"></div>
        </div>

        <!-- Allowed IPs -->
        <div>
            <label for="allowedIPs">Allowed IPs:</label>
            <input type="text" id="allowedIPs" placeholder="مثلاً 0.0.0.0/4" value="0.0.0.0/4">
        </div>

        <!-- بخش آدرس کانفیگ -->
        <div>
            <label for="addresses">آدرس‌ها (Address):</label>
            <div id="addressList" class="list-box"></div>
            <!-- دکمه‌های پیش‌نمایش آدرس -->
            <button id="previewAddressIPv4" class="small-btn">پیش‌نمایش آدرس IPv4</button>
            <button id="previewAddressIPv6" class="small-btn">پیش‌نمایش آدرس IPv6</button>
            <!-- ناحیه کاندیدای پیش‌نمایش آدرس -->
            <div id="addressCandidate"></div>
            <input type="text" id="customAddress" placeholder="یا وارد کردن آدرس دلخواه">
            <!-- بخش آدرس‌های پیشفرض -->
            <div style="margin-top:10px;">
                <label>آدرس‌های پیشفرض:</label>
                <div id="defaultAddressesContainer">
                    <!-- آیتم 1 -->
                    <div class="default-address-item">
                        <div class="checkbox-wrapper-3">
                            <input type="checkbox" id="defaultAddr1" value="10.202.10.10/32">
                            <label for="defaultAddr1" class="toggle"><span></span></label>
                        </div>
                        <label for="defaultAddr1" class="inline">10.202.10.10/32</label>
                    </div>
                    <!-- آیتم 2 -->
                    <div class="default-address-item">
                        <div class="checkbox-wrapper-3">
                            <input type="checkbox" id="defaultAddr2" value="10.202.10.11/32">
                            <label for="defaultAddr2" class="toggle"><span></span></label>
                        </div>
                        <label for="defaultAddr2" class="inline">10.202.10.11/32</label>
                    </div>
                    <!-- آیتم 3 -->
                    <div class="default-address-item">
                        <div class="checkbox-wrapper-3">
                            <input type="checkbox" id="defaultAddr3" value="10.202.10.10/24">
                            <label for="defaultAddr3" class="toggle"><span></span></label>
                        </div>
                        <label for="defaultAddr3" class="inline">10.202.10.10/24</label>
                    </div>
                    <!-- آیتم 4 -->
                    <div class="default-address-item">
                        <div class="checkbox-wrapper-3">
                            <input type="checkbox" id="defaultAddr4" value="10.202.10.11/24">
                            <label for="defaultAddr4" class="toggle"><span></span></label>
                        </div>
                        <label for="defaultAddr4" class="inline">10.202.10.11/24</label>
                    </div>
                    <!-- آیتم 5 -->
                    <div class="default-address-item">
                        <div class="checkbox-wrapper-3">
                            <input type="checkbox" id="defaultAddr5" value="78.157.42.100/32">
                            <label for="defaultAddr5" class="toggle"><span></span></label>
                        </div>
                        <label for="defaultAddr5" class="inline">78.157.42.100/32</label>
                    </div>
                    <!-- آیتم 6 -->
                    <div class="default-address-item">
                        <div class="checkbox-wrapper-3">
                            <input type="checkbox" id="defaultAddr6" value="78.157.42.101/32">
                            <label for="defaultAddr6" class="toggle"><span></span></label>
                        </div>
                        <label for="defaultAddr6" class="inline">78.157.42.101/32</label>
                    </div>
                    <!-- آیتم 7 -->
                    <div class="default-address-item">
                        <div class="checkbox-wrapper-3">
                            <input type="checkbox" id="defaultAddr7" value="78.157.42.100/24">
                            <label for="defaultAddr7" class="toggle"><span></span></label>
                        </div>
                        <label for="defaultAddr7" class="inline">78.157.42.100/24</label>
                    </div>
                    <!-- آیتم 8 -->
                    <div class="default-address-item">
                        <div class="checkbox-wrapper-3">
                            <input type="checkbox" id="defaultAddr8" value="78.157.42.101/24">
                            <label for="defaultAddr8" class="toggle"><span></span></label>
                        </div>
                        <label for="defaultAddr8" class="inline">78.157.42.101/24</label>
                    </div>
                    <!-- آیتم 9 -->
                    <div class="default-address-item">
                        <div class="checkbox-wrapper-3">
                            <input type="checkbox" id="defaultAddr9" value="10.0.0.0/16">
                            <label for="defaultAddr9" class="toggle"><span></span></label>
                        </div>
                        <label for="defaultAddr9" class="inline">10.0.0.0/16</label>
                    </div>
                    <!-- آیتم 10 -->
                    <div class="default-address-item">
                        <div class="checkbox-wrapper-3">
                            <input type="checkbox" id="defaultAddr10" value="10.0.0.0/24">
                            <label for="defaultAddr10" class="toggle"><span></span></label>
                        </div>
                        <label for="defaultAddr10" class="inline">10.0.0.0/24</label>
                    </div>
                    <!-- آیتم 11 -->
                    <div class="default-address-item">
                        <div class="checkbox-wrapper-3">
                            <input type="checkbox" id="defaultAddr11" value="8.8.8.8/32">
                            <label for="defaultAddr11" class="toggle"><span></span></label>
                        </div>
                        <label for="defaultAddr11" class="inline">8.8.8.8/32</label>
                    </div>
                    <!-- آیتم 12 -->
                    <div class="default-address-item">
                        <div class="checkbox-wrapper-3">
                            <input type="checkbox" id="defaultAddr12" value="8.8.8.8/24">
                            <label for="defaultAddr12" class="toggle"><span></span></label>
                        </div>
                        <label for="defaultAddr12" class="inline">8.8.8.8/24</label>
                    </div>
                </div>
            </div>
        </div>

        <!-- بخش DNS -->
        <div>
            <label for="dnsSection">DNS:</label>
            <div id="dnsList" class="list-box"></div>
            <!-- دکمه‌های پیش‌نمایش برای DNS (این بخش همچنان از تولید آدرس تصادفی استفاده می‌کند) -->
            <button id="previewDNSIPv4" class="small-btn">پیش‌نمایش DNS IPv4</button>
            <button id="previewDNSIPv6" class="small-btn">پیش‌نمایش DNS IPv6</button>
            <div id="dnsCandidate"></div>
            <input type="text" id="customDNS" placeholder="یا وارد کردن DNS دلخواه">
        </div>

        <!-- دکمه تولید کانفیگ نهایی -->
        <div>
            <button id="generateConfig">تولید کانفیگ نهایی</button>
        </div>

        <!-- نمایش کانفیگ تولید شده (کادر بزرگ) -->
        <div>
            <label for="configOutput">کانفیگ تولید شده:</label>
            <textarea id="configOutput" readonly></textarea>
        </div>

        <!-- دکمه‌های دانلود -->
        <div>
            <button id="downloadConfig">دانلود مستقیم کانفیگ</button>
            <input type="text" id="zipFilename" placeholder="نام فایل Zip (بدون پسوند)">
            <button id="downloadZip">دانلود به صورت Zip</button>
        </div>

    </div>

    <script>
        // ذخیره کلیدهای تولید‌شده در متغیر سراسری
        let generatedKeys = null;

        // ساختار لوکیشن‌ها به صورت آرایه‌ای برای ipv4 و ipv6
        const locations = {
            SA: {
                name: "عربستان",
                ipv4: [
                    "176.16.0.0/14",
                    "37.104.0.0/14",
                    "37.124.0.0/14",
                    "5.108.0.0/14",
                    "94.96.0.0/14",
                    "109.82.0.0/15",
                    "176.44.0.0/15",
                    "188.48.0.0/15",
                    "2.88.0.0/15",
                    "31.166.0.0/15",
                    "37.42.0.0/15",
                    "46.152.0.0/15",
                    "5.244.0.0/15",
                    "50.60.0.0/15",
                    "94.48.0.0/15",
                    "95.218.0.0/15",
                    "141.179.0.0/16",
                    "142.247.0.0/16",
                    "145.82.0.0/16",
                    "146.251.0.0/16",
                    "148.111.0.0/16",
                    "149.109.0.0/16",
                    "151.173.0.0/16",
                    "161.251.0.0/16",
                    "161.70.0.0/16",
                    "176.224.0.0/16",
                    "178.80.0.0/16",
                    "178.87.0.0/16",
                    "180.234.0.0/16",
                    "188.50.0.0/16",
                    "188.54.0.0/16",
                    "2.91.0.0/16",
                    "37.121.0.0/16",
                    "37.141.0.0/16",
                    "37.217.0.0/16",
                    "37.243.0.0/16",
                    "5.246.0.0/16",
                    "5.82.0.0/16",
                    "50.119.0.0/16",
                    "51.218.0.0/16",
                    "51.223.0.0/16",
                    "62.120.0.0/16",
                    "77.30.0.0/16",
                    "87.109.0.0/16",
                    "90.148.0.0/16",
                    "93.112.0.0/16",
                    "130.164.128.0/17",
                    "139.64.0.0/17",
                    "141.164.128.0/17",
                    "142.154.0.0/17",
                    "143.92.128.0/17",
                    "144.86.0.0/17",
                    "159.0.0.0/17",
                    "162.142.128.0/17",
                    "167.100.128.0/17",
                    "167.86.128.0/17",
                    "168.149.0.0/17",
                    "169.148.0.0/17",
                    "170.101.128.0/17",
                    "175.110.128.0/17",
                    "176.225.128.0/17",
                    "176.47.128.0/17",
                    "178.86.128.0/17",
                    "188.132.0.0/17",
                    "188.224.128.0/17",
                    "188.51.0.0/17",
                    "188.52.0.0/17",
                    "188.55.128.0/17",
                    "37.16.128.0/17",
                    "37.216.0.0/17",
                    "37.240.0.0/17",
                    "37.241.0.0/17",
                    "37.242.128.0/17",
                    "37.56.128.0/17",
                    "46.230.0.0/17",
                    "46.240.0.0/17",
                    "46.52.0.0/17",
                    "5.163.128.0/17",
                    "77.31.0.0/17",
                    "86.51.128.0/17",
                    "95.184.128.0/17",
                    "128.234.0.0/18",
                    "128.234.128.0/18",
                    "129.208.0.0/18",
                    "129.208.128.0/18",
                    "153.94.64.0/18",
                    "159.0.192.0/18",
                    "170.133.64.0/18",
                    "174.140.0.0/18",
                    "178.130.192.0/18",
                    "178.73.64.0/18",
                    "178.81.0.0/18",
                    "178.81.192.0/18",
                    "178.86.64.0/18",
                    "188.51.128.0/18",
                    "188.53.128.0/18",
                    "188.55.64.0/18",
                    "2.90.0.0/18",
                    "205.238.64.0/18",
                    "37.216.128.0/18",
                    "37.240.128.0/18",
                    "37.241.128.0/18",
                    "37.242.64.0/18",
                    "37.56.0.0/18",
                    "46.44.64.0/18",
                    "51.211.0.0/18",
                    "51.211.192.0/18",
                    "62.149.64.0/18",
                    "66.9.192.0/18",
                    "77.31.128.0/18",
                    "77.90.192.0/18",
                    "78.138.192.0/18",
                    "85.195.128.0/18",
                    "85.196.0.0/18",
                    "86.51.0.0/18",
                    "87.76.64.0/18",
                    "92.48.0.0/18",
                    "104.114.192.0/19",
                    "109.166.0.0/19",
                    "109.166.96.0/19",
                    "109.206.64.0/19",
                    "128.234.192.0/19",
                    "128.234.64.0/19",
                    "129.208.224.0/19",
                    "129.208.96.0/19",
                    "159.0.128.0/19",
                    "188.51.224.0/19",
                    "188.52.160.0/19",
                    "188.52.192.0/19",
                    "188.55.32.0/19",
                    "196.15.32.0/19",
                    "207.150.160.0/19",
                    "207.178.64.0/19",
                    "212.2.128.0/19",
                    "212.215.160.0/19",
                    "37.16.32.0/19",
                    "37.216.224.0/19",
                    "37.224.32.0/19",
                    "37.224.96.0/19",
                    "37.242.32.0/19",
                    "37.25.0.0/19",
                    "37.56.96.0/19",
                    "46.251.128.0/19",
                    "5.163.0.0/19",
                    "5.163.96.0/19",
                    "51.211.160.0/19",
                    "51.211.64.0/19",
                    "51.235.0.0/19",
                    "51.235.128.0/19",
                    "64.16.192.0/19",
                    "66.212.96.0/19",
                    "77.236.128.0/19",
                    "77.247.32.0/19",
                    "86.51.96.0/19",
                    "159.0.160.0/20",
                    "176.32.208.0/20",
                    "176.99.16.0/20",
                    "178.218.176.0/20",
                    "188.52.240.0/20",
                    "188.53.240.0/20",
                    "188.53.80.0/20",
                    "212.118.128.0/20",
                    "212.215.144.0/20",
                    "212.215.192.0/20",
                    "212.215.240.0/20",
                    "23.41.48.0/20",
                    "37.216.208.0/20",
                    "37.224.144.0/20",
                    "37.224.16.0/20",
                    "37.224.208.0/20",
                    "37.224.80.0/20",
                    "46.149.0.0/20",
                    "51.211.96.0/20",
                    "84.235.16.0/20",
                    "84.235.32.0/20",
                    "86.51.64.0/20"
                ],
                ipv6: [
                    "2a00:f580::/32",
                    "2a02:ce0::/32",
                    "2a02:9b0:8000::/33",
                    "2a02:9b0:2000::/35",
                    "2a02:9b0:6000::/35",
                    "2a02:9b0:1000::/36",
                    "2a02:9b0:5000::/36",
                    "2a02:9b0:800::/37",
                    "2a02:9b0:4800::/37",
                    "2a02:9b0:400::/38",
                    "2a02:9b0:4400::/38",
                    "2a02:9b0:200::/39",
                    "2a02:9b0:4200::/39",
                    "2a02:9b0:100::/40",
                    "2a02:9b0:4100::/40",
                    "2a02:9b0:80::/41",
                    "2a02:9b0:4080::/41",
                    "2a02:9b0:4040::/42",
                    "2a02:9b0:4020::/43",
                    "2a02:9b0::/44",
                    "2a02:9b0:30::/44",
                    "2a02:9b0:40::/44",
                    "2a02:9b0:70::/44",
                    "2a02:9b0:4010::/44",
                    "2a02:9b0:10::/45",
                    "2a02:9b0:28::/45",
                    "2a02:9b0:50::/45",
                    "2a02:9b0:68::/45",
                    "2a02:9b0:4008::/45",
                    "2a02:9b0:18::/46",
                    "2a02:9b0:58::/46",
                    "2a02:9b0:64::/46",
                    "2a02:9b0:4004::/46",
                    "2a02:9b0:1c::/47",
                    "2a02:9b0:62::/47",
                    "2a02:9b0:4002::/47",
                    "2a03:2887:ff10::/47",
                    "2001:3c80:4000::/48",
                    "2600:1417:d000::/48",
                    "2600:1417:d800::/48",
                    "2a02:9b0:4001::/48",
                    "2a03:2887:ff0d::/48",
                    "2a03:2887:ff0f::/48",
                    "2a03:2887:ff13::/48",
                    "2a03:2887:ff15::/48",
                    "2001:16a2:5000::/36",
                    "2001:16a2:f000::/36",
                    "2001:16a2:6800::/37",
                    "2001:16a2:c800::/37",
                    "2001:16a2:d800::/37",
                    "2001:16a2:e000::/37",
                    "2001:16a2:3000::/38",
                    "2001:16a2:400::/38",
                    "2001:16a2:800::/38",
                    "2001:16a2:3800::/38",
                    "2001:16a2:4c00::/38",
                    "2001:16a2:7400::/38",
                    "2001:16a2:7800::/38",
                    "2001:16a2:c400::/38",
                    "2001:16a2:e800::/38",
                    "2001:16a3:800::/38",
                    "2001:16a3:e00::/39",
                    "2001:16a2:2e00::/39",
                    "2001:16a2:200::/39",
                    "2001:16a2:3e00::/39",
                    "2001:16a2:4200::/39",
                    "2001:16a2:4400::/39",
                    "2001:16a2:6600::/39",
                    "2001:16a2:7000::/39",
                    "2001:16a2:ec00::/39",
                    "2001:16a3:600::/39",
                    "2001:16a2:4600::/40",
                    "2001:16a2:6000::/40",
                    "2001:16a2:6200::/40",
                    "2001:16a2:7c00::/40",
                    "2001:16a2:d700::/40",
                    "2001:16a6:c100::/40",
                    "2001:16a2::/44",
                    "2001:16a2:8000::/44",
                    "2001:16a2:4010::/45",
                    "2001:16a2:4020::/45",
                    "2001:16a2:8030::/45",
                    "2001:16a2:10::/46",
                    "2001:16a2:34::/46",
                    "2001:16a2:3c::/46",
                    "2001:16a2:360c::/46",
                    "2001:16a2:3610::/46",
                    "2001:16a2:400c::/46",
                    "2001:16a2:4018::/46",
                    "2001:16a2:402c::/46",
                    "2001:16a2:8010::/46",
                    "2001:16a2:8040::/46",
                    "2001:16a2:b20c::/46",
                    "2001:16a2:b210::/46",
                    "2001:3c80:b044::/46",
                    "2001:16a0:2::/47",
                    "2001:16a2:14::/47",
                    "2001:16a2:3a::/47",
                    "2001:16a2:360a::/47",
                    "2001:16a2:3614::/47",
                    "2001:16a2:400a::/47",
                    "2001:16a2:401c::/47",
                    "2001:16a2:402a::/47",
                    "2001:16a2:4030::/47",
                    "2001:16a2:8014::/47",
                    "2001:16a2:b214::/47",
                    "2001:3c80:b042::/47",
                    "2001:3c80:b048::/47",
                    "2001:16a0:1::/48",
                    "2001:16a0:6000::/48",
                    "2001:3c80:8000::/48",
                    "2001:3c80:b041::/48",
                    "2001:3c80:b04a::/48",
                    "2600:1416:2000::/48",
                    "2600:1416:e000::/48",
                    "2600:1417:f800::/48"
                ]
            },
            UK: {
                name: "انگلستان",
                ipv4: [
                    "5.254.64.0/18",
                    "5.254.0.0/19",
                    "109.163.224.0/20",
                    "37.221.160.0/20",
                    "5.254.32.0/20",
                    "93.115.80.0/20"
                ],
                ipv6: [
                    "2a03:5180:10::/46",
                    "2001:67c:b30::/48",
                    "2602:ff84:8::/48",
                    "2a03:5180::/44",
                    "2a03:5180:15::/48",
                    "2a03:5180:16::/48"
                ]
            },
            SE: {
                name: "سوئد",
                ipv4: [
                    "90.128.0.0/12",
                    "95.192.0.0/12",
                    "2.64.0.0/13",
                    "217.208.0.0/13",
                    "78.72.0.0/13",
                    "83.176.0.0/13",
                    "83.248.0.0/13",
                    "109.56.0.0/14",
                    "176.68.0.0/14",
                    "193.12.0.0/14",
                    "2.248.0.0/14",
                    "213.100.0.0/14",
                    "213.64.0.0/14",
                    "37.196.0.0/14",
                    "5.240.0.0/14",
                    "77.216.0.0/14",
                    "78.64.0.0/14",
                    "81.224.0.0/14",
                    "81.236.0.0/14",
                    "83.184.0.0/14",
                    "90.228.0.0/14",
                    "90.236.0.0/14",
                    "91.128.0.0/14",
                    "188.150.0.0/15",
                    "193.216.0.0/15",
                    "194.16.0.0/15",
                    "194.22.0.0/15",
                    "37.2.0.0/15",
                    "80.216.0.0/15",
                    "81.230.0.0/15",
                    "81.232.0.0/15",
                    "83.188.0.0/15",
                    "90.226.0.0/15",
                    "90.234.0.0/15",
                    "130.244.0.0/16",
                    "148.136.0.0/16",
                    "150.227.0.0/16",
                    "151.177.0.0/16",
                    "159.190.0.0/16",
                    "159.193.0.0/16",
                    "188.149.0.0/16",
                    "193.45.0.0/16",
                    "194.18.0.0/16",
                    "194.218.0.0/16",
                    "195.198.0.0/16",
                    "195.67.0.0/16",
                    "195.84.0.0/16",
                    "212.151.0.0/16",
                    "212.181.0.0/16",
                    "212.214.0.0/16",
                    "212.247.0.0/16",
                    "213.50.0.0/16",
                    "213.89.0.0/16",
                    "37.250.0.0/16",
                    "62.20.0.0/16",
                    "78.68.0.0/16",
                    "78.71.0.0/16",
                    "80.170.0.0/16",
                    "81.216.0.0/16",
                    "81.229.0.0/16",
                    "81.235.0.0/16",
                    "83.190.0.0/16",
                    "88.131.0.0/16",
                    "90.144.0.0/16",
                    "90.225.0.0/16",
                    "90.233.0.0/16",
                    "95.209.0.0/16",
                    "188.148.0.0/17",
                    "194.236.128.0/17",
                    "194.237.0.0/17",
                    "213.88.128.0/17",
                    "37.0.128.0/17",
                    "62.95.0.0/17",
                    "78.69.0.0/17",
                    "78.70.128.0/17",
                    "79.138.128.0/17",
                    "81.228.128.0/17",
                    "81.234.128.0/17",
                    "83.191.128.0/17",
                    "87.227.0.0/17",
                    "90.224.128.0/17",
                    "90.232.0.0/17",
                    "92.254.128.0/17",
                    "94.186.0.0/17",
                    "94.191.128.0/17",
                    "95.109.0.0/17",
                    "188.148.192.0/18",
                    "193.150.192.0/18",
                    "193.44.0.0/18",
                    "193.44.192.0/18",
                    "194.236.0.0/18",
                    "194.237.192.0/18",
                    "213.200.128.0/18",
                    "62.181.64.0/18",
                    "77.110.0.0/18",
                    "78.28.64.0/18",
                    "78.69.128.0/18",
                    "78.70.64.0/18",
                    "81.228.64.0/18",
                    "81.234.0.0/18",
                    "83.191.0.0/18",
                    "85.11.0.0/18",
                    "85.194.0.0/18",
                    "90.224.0.0/18",
                    "90.232.192.0/18",
                    "95.153.0.0/18",
                    "156.51.224.0/19",
                    "188.126.224.0/19",
                    "188.148.128.0/19",
                    "193.44.128.0/19",
                    "193.44.96.0/19",
                    "194.236.64.0/19",
                    "194.237.160.0/19",
                    "195.22.64.0/19",
                    "195.252.32.0/19",
                    "195.42.192.0/19",
                    "195.54.128.0/19",
                    "2.255.128.0/19",
                    "212.119.128.0/19",
                    "212.152.0.0/19",
                    "212.162.160.0/19",
                    "212.27.0.0/19",
                    "212.28.192.0/19",
                    "213.130.192.0/19",
                    "213.131.128.0/19",
                    "213.134.96.0/19",
                    "213.173.192.0/19",
                    "213.187.192.0/19",
                    "31.15.32.0/19",
                    "62.65.0.0/19",
                    "77.233.64.0/19",
                    "78.156.192.0/19",
                    "78.69.192.0/19",
                    "78.70.32.0/19",
                    "81.228.32.0/19",
                    "81.234.64.0/19",
                    "83.191.64.0/19",
                    "88.84.224.0/19",
                    "90.224.96.0/19",
                    "90.232.128.0/19",
                    "156.51.208.0/20",
                    "188.148.160.0/20",
                    "193.44.176.0/20",
                    "193.44.80.0/20",
                    "194.236.96.0/20",
                    "194.237.144.0/20",
                    "2.255.160.0/20",
                    "212.107.32.0/20",
                    "217.119.160.0/20",
                    "217.25.240.0/20",
                    "217.67.80.0/20",
                    "217.78.16.0/20",
                    "37.233.64.0/20",
                    "77.241.128.0/20",
                    "78.69.224.0/20",
                    "78.70.0.0/20",
                    "80.251.192.0/20",
                    "80.85.112.0/20",
                    "81.21.240.0/20",
                    "81.228.16.0/20",
                    "81.234.112.0/20",
                    "83.191.96.0/20",
                    "90.224.64.0/20",
                    "90.232.160.0/20"
                ],
                ipv6: [
                    "2a00:840::/26",
                    "2a04:ae00::/26",
                    "2a00:820::/27",
                    "2a00:810::/28",
                    "2001:6f0::/29",
                    "2a00:808::/29",
                    "2a03:12a0::/29",
                    "2a0a:3740::/29",
                    "2a13:d480::/29",
                    "2a00:804::/30",
                    "2a02:aa0::/30",
                    "2001:2042::/31",
                    "2001:2090::/31",
                    "2a00:802::/31",
                    "2a02:aa4::/31",
                    "2001:2040::/32",
                    "2001:2044::/32",
                    "2a00:800::/32",
                    "2a00:cc8::/32",
                    "2a01:b880::/32",
                    "2a02:2348::/32",
                    "2a02:5120::/32",
                    "2a02:aa6::/32",
                    "2a00:801:8000::/33",
                    "2a01:1b8:8000::/33",
                    "2a02:aa7:8000::/33",
                    "2a00:801:4000::/34",
                    "2a01:1b8:4000::/34",
                    "2a02:aa7::/34",
                    "2a00:801:2000::/35",
                    "2a01:1b8:2000::/35",
                    "2a02:aa7:6000::/35",
                    "2001:2001:4000::/36",
                    "2a00:801:1000::/36",
                    "2a01:1b8:1000::/36",
                    "2a02:aa7:5000::/36",
                    "2a00:801:800::/37",
                    "2a01:1b8:800::/37",
                    "2a02:aa7:4800::/37",
                    "2a00:801::/38",
                    "2a01:1b8:400::/38",
                    "2a02:aa7:4000::/38",
                    "2a00:801:400::/39",
                    "2a01:1b8:200::/39",
                    "2a02:aa7:4400::/39",
                    "2001:2000:4000::/40",
                    "2001:2000:9000::/40",
                    "2a00:801:600::/40",
                    "2a01:1b8:100::/40",
                    "2a02:aa7:4700::/40",
                    "2a00:801:780::/41",
                    "2a01:1b8:80::/41",
                    "2a02:aa7:4680::/41",
                    "2a00:801:740::/42",
                    "2a01:1b8:40::/42",
                    "2a02:aa7:4640::/42",
                    "2a00:801:720::/43",
                    "2a01:1b8:20::/43",
                    "2a02:aa7:4620::/43",
                    "2a00:801:710::/44",
                    "2a01:1b8:10::/44",
                    "2a02:aa7:4610::/44",
                    "2a00:801:700::/45",
                    "2a01:1b8:8::/45",
                    "2a02:aa7:4600::/45",
                    "2a00:801:708::/46",
                    "2a01:1b8::/46",
                    "2a02:aa7:4608::/46",
                    "2a00:801:70e::/47",
                    "2a01:1b8:6::/47",
                    "2a01:4400:2::/47",
                    "2a01:4400:4::/47",
                    "2a02:aa7:460c::/47",
                    "2001:2000::/48",
                    "2001:678:240::/48",
                    "2001:678:330::/48",
                    "2001:678:3ec::/48",
                    "2001:678:450::/48",
                    "2001:678:454::/48",
                    "2001:678:704::/48",
                    "2001:678:784::/48",
                    "2001:678:884::/48",
                    "2001:678:d5c::/48",
                    "2001:678:edc::/48",
                    "2001:67c:10c8::/48",
                    "2001:67c:10cc::/48",
                    "2001:67c:10fc::/48",
                    "2001:67c:1118::/48",
                    "2001:67c:11cc::/48",
                    "2001:67c:13f4::/48",
                    "2001:67c:1488::/48",
                    "2001:67c:14dc::/48",
                    "2001:67c:1544::/48",
                    "2001:67c:15c8::/48",
                    "2001:67c:15e8::/48",
                    "2001:67c:1770::/48",
                    "2001:67c:17bc::/48",
                    "2001:67c:17cc::/48",
                    "2001:67c:17dc::/48",
                    "2001:67c:17f4::/48",
                    "2001:67c:1830::/48",
                    "2001:67c:1878::/48",
                    "2001:67c:1894::/48",
                    "2001:67c:189c::/48",
                    "2001:67c:1910::/48",
                    "2001:67c:1920::/48",
                    "2001:67c:2214::/48",
                    "2001:67c:22c0::/48",
                    "2001:67c:22c8::/48",
                    "2001:67c:2650::/48",
                    "2001:67c:27a4::/48",
                    "2001:67c:28c4::/48",
                    "2001:67c:2910::/48",
                    "2001:67c:2a98::/48",
                    "2001:67c:2ab4::/48",
                    "2001:67c:2ab8::/48",
                    "2001:67c:2b24::/48",
                    "2001:67c:2b48::/48",
                    "2001:67c:2b6c::/48",
                    "2001:67c:2bc0::/48",
                    "2001:67c:2bd4::/48",
                    "2001:67c:2bf8::/48",
                    "2001:67c:2c4c::/48",
                    "2001:67c:448::/48",
                    "2001:67c:488::/48",
                    "2001:67c:4a4::/48",
                    "2001:67c:540::/48",
                    "2a00:801:70c::/48",
                    "2a01:1b8:4::/48",
                    "2a01:280:310::/48",
                    "2a01:280:370::/48",
                    "2a01:280:390::/48",
                    "2a01:280:3b8::/48",
                    "2a01:4400:1::/48",
                    "2a01:4400:4747::/48",
                    "2a01:4400:6::/48",
                    "2a01:7ee0::/48",
                    "2a01:aa80::/48",
                    "2a02:aa7:460e::/48",
                    "2a11:cd40:1000::/48"
                ]
            },
            DE: {
                name: "آلمان",
                ipv4: [
                    "84.128.0.0/10",
                    "87.128.0.0/10",
                    "91.0.0.0/10",
                    "79.192.0.0/10",
                    "93.192.0.0/10",
                    "217.224.0.0/11",
                    "80.128.0.0/11",
                    "91.32.0.0/11",
                    "93.192.0.0/11",
                    "217.80.0.0/12",
                    "193.104.33.0/24",
                    "151.242.112.0/23",
                    "151.242.98.0/24",
                    "151.242.96.0/24",
                    "151.242.115.0/24",
                    "185.234.22.0/24",
                    "151.242.109.0/24",
                    "151.242.103.0/24",
                    "151.242.107.0/24",
                    "151.242.105.0/24",
                    "82.22.191.0/24",
                    "82.22.194.0/24",
                    "82.22.187.0/24",
                    "91.210.144.0/24",
                    "84.154.155.44/30",
                    "84.154.155.128/25",
                    "84.154.155.42/31",
                    "84.154.160.0/19",
                    "84.154.156.0/22",
                    "84.154.144.0/21",
                    "84.154.155.64/26",
                    "84.154.155.32/29",
                    "84.154.155.40/32",
                    "84.154.155.0/27",
                    "84.154.192.0/18",
                    "84.154.154.0/24",
                    "84.154.0.0/17",
                    "84.154.128.0/20",
                    "84.155.0.0/16",
                    "84.154.152.0/23",
                    "84.154.155.48/28",
                    "84.152.0.0/15",
                    "185.133.243.0/24",
                    "82.29.120.0/23",
                    "151.242.92.0/22",
                    "91.124.38.0/24",
                    "84.55.1.0/24",
                    "217.181.64.0/21",
                    "82.29.29.0/24",
                    "82.29.70.0/24",
                    "82.29.73.0/24",
                    "82.29.79.0/24",
                    "82.29.45.0/24",
                    "82.29.49.0/24",
                    "82.29.39.0/24",
                    "82.29.76.0/24",
                    "82.29.23.0/24",
                    "82.29.36.0/24",
                    "82.29.51.0/24",
                    "82.29.65.0/24",
                    "151.242.100.0/23",
                    "82.21.184.0/24",
                    "82.21.153.0/24",
                    "80.187.0.0/16",
                    "82.24.52.0/24",
                    "82.22.161.0/24",
                    "178.132.194.0/24",
                    "82.26.197.0/24",
                    "82.25.197.0/24",
                    "82.26.111.0/24",
                    "82.26.123.0/24",
                    "82.27.10.0/24",
                    "82.23.168.0/24",
                    "82.21.57.0/24",
                    "82.25.202.0/24",
                    "62.224.0.0/14",
                    "82.23.197.0/24",
                    "194.49.125.0/24",
                    "82.27.198.0/24",
                    "82.27.22.0/24",
                    "82.26.175.0/24",
                    "82.26.141.0/24",
                    "82.26.168.0/24",
                    "82.26.155.0/24",
                    "82.26.161.0/24",
                    "82.26.198.0/24",
                    "82.26.147.0/24",
                    "194.152.142.0/24",
                    "195.243.0.0/16",
                    "2.58.100.0/24",
                    "2.58.102.0/24",
                    "2.160.0.0/12",
                    "5.35.192.0/21",
                    "5.133.112.0/24",
                    "5.249.188.0/22",
                    "31.212.0.0/15",
                    "31.224.0.0/11",
                    "37.46.11.0/24",
                    "37.50.0.0/15",
                    "37.80.0.0/12",
                    "37.143.3.0/24",
                    "37.230.61.0/24",
                    "45.93.186.0/23",
                    "45.112.192.0/24",
                    "45.129.165.0/24",
                    "45.132.80.0/22",
                    "45.141.54.0/24",
                    "45.145.16.0/24",
                    "45.147.227.0/24",
                    "45.149.7.0/24",
                    "45.155.77.0/24",
                    "45.157.158.0/23",
                    "45.195.80.0/24",
                    "46.78.0.0/15",
                    "46.80.0.0/12",
                    "46.202.0.0/24",
                    "62.56.208.0/21",
                    "62.153.0.0/16",
                    "62.154.0.0/15",
                    "62.156.0.0/14",
                    "64.137.34.0/23",
                    "64.137.40.0/23",
                    "64.137.119.0/24",
                    "64.137.125.0/24",
                    "64.137.127.0/24",
                    "65.75.200.0/22",
                    "68.168.18.0/23",
                    "77.47.152.0/22",
                    "77.83.136.0/22",
                    "77.90.156.0/24",
                    "77.90.184.0/24",
                    "79.192.0.0/15",
                    "79.194.0.0/17",
                    "79.194.128.0/20",
                    "79.194.144.0/25",
                    "79.194.144.128/27",
                    "79.194.144.160/28",
                    "79.194.144.176/29",
                    "79.194.144.184/30",
                    "79.194.144.188/31",
                    "79.194.144.191/32",
                    "79.194.144.192/26",
                    "79.194.145.0/24",
                    "79.194.146.0/23",
                    "79.194.148.0/22",
                    "79.194.152.0/21",
                    "79.194.160.0/19",
                    "79.194.192.0/18",
                    "79.195.0.0/16",
                    "79.196.0.0/14",
                    "79.200.0.0/13",
                    "79.208.0.0/12",
                    "79.224.0.0/11",
                    "80.64.240.0/22",
                    "80.71.231.0/24",
                    "80.71.233.0/24",
                    "80.71.235.0/24",
                    "80.71.236.0/24",
                    "80.71.238.0/24",
                    "80.83.80.0/21",
                    "80.128.0.0/13",
                    "80.136.0.0/14",
                    "80.140.0.0/15",
                    "80.142.0.0/16",
                    "80.143.0.0/17",
                    "80.143.128.0/19",
                    "80.143.160.0/21",
                    "80.143.168.0/22",
                    "80.143.172.0/26",
                    "80.143.172.64/27",
                    "80.143.172.96/29",
                    "80.143.172.104/32",
                    "80.143.172.106/31",
                    "80.143.172.108/30",
                    "80.143.172.112/28",
                    "80.143.172.128/25",
                    "80.143.173.0/24",
                    "80.143.174.0/23",
                    "80.143.176.0/20",
                    "80.143.192.0/18",
                    "80.144.0.0/13",
                    "80.152.0.0/14",
                    "80.156.0.0/15",
                    "80.158.128.0/17",
                    "80.159.0.0/17",
                    "80.159.128.0/18",
                    "80.159.192.0/19",
                    "81.31.210.0/23",
                    "81.199.64.0/20",
                    "81.201.32.0/20",
                    "82.163.60.0/22",
                    "82.163.104.0/21",
                    "82.206.32.0/19",
                    "82.215.70.0/24",
                    "83.243.48.0/21",
                    "84.32.48.0/22",
                    "84.32.108.0/22",
                    "84.55.17.0/24",
                    "84.55.22.0/24",
                    "84.128.0.0/12",
                    "84.144.0.0/13",
                    "84.156.0.0/16",
                    "84.157.0.0/18",
                    "84.157.64.0/20",
                    "84.157.80.0/21",
                    "84.157.88.0/23",
                    "84.157.90.0/24",
                    "84.157.91.0/25",
                    "84.157.91.128/27",
                    "84.157.91.160/30",
                    "84.157.91.164/31",
                    "84.157.91.166/32",
                    "84.157.91.168/29",
                    "84.157.91.176/28",
                    "84.157.91.192/26",
                    "84.157.92.0/22",
                    "84.157.96.0/19",
                    "84.157.128.0/17",
                    "84.158.0.0/15",
                    "84.160.0.0/11",
                    "84.246.111.0/24",
                    "85.119.160.0/23",
                    "85.133.208.0/24",
                    "85.133.214.0/24",
                    "85.133.254.0/24",
                    "85.204.160.0/22",
                    "85.204.181.0/24",
                    "86.38.37.0/24",
                    "86.105.58.0/24",
                    "86.105.211.0/24",
                    "86.107.164.0/24",
                    "86.110.57.0/24",
                    "87.128.0.0/14",
                    "87.132.0.0/15",
                    "87.134.0.0/18",
                    "87.134.64.0/19",
                    "87.134.96.0/24",
                    "87.134.97.0/25",
                    "87.134.97.128/27",
                    "87.134.97.160/32",
                    "87.134.97.162/31",
                    "87.134.97.164/30",
                    "87.134.97.168/29",
                    "87.134.97.176/28",
                    "87.134.97.192/26",
                    "87.134.98.0/23",
                    "87.134.100.0/22",
                    "87.134.104.0/21",
                    "87.134.112.0/20",
                    "87.134.128.0/17",
                    "87.135.0.0/16",
                    "87.136.0.0/13",
                    "87.144.0.0/14",
                    "87.148.0.0/15",
                    "87.150.0.0/19",
                    "87.150.32.0/21",
                    "87.150.40.0/27",
                    "87.150.40.32/29",
                    "87.150.40.40/30",
                    "87.150.40.44/31",
                    "87.150.40.47/32",
                    "87.150.40.48/28",
                    "87.150.40.64/26",
                    "87.150.40.128/25",
                    "87.150.41.0/24",
                    "87.150.42.0/23",
                    "87.150.44.0/22",
                    "87.150.48.0/20",
                    "87.150.64.0/18",
                    "87.150.128.0/17",
                    "87.151.0.0/16",
                    "87.152.0.0/13",
                    "87.160.0.0/11",
                    "87.237.240.0/21",
                    "88.128.0.0/16",
                    "88.135.96.0/22",
                    "88.216.60.0/22",
                    "88.216.224.0/22",
                    "89.39.97.0/24",
                    "89.39.172.0/23",
                    "89.213.186.0/23",
                    "91.0.0.0/11",
                    "91.32.0.0/12",
                    "91.48.0.0/13",
                    "91.56.0.0/15",
                    "91.58.0.0/17",
                    "91.58.128.0/18",
                    "91.58.192.0/21",
                    "91.58.200.0/25",
                    "91.58.200.128/27",
                    "91.58.200.160/31",
                    "91.58.200.162/32",
                    "91.58.200.164/30",
                    "91.58.200.168/29",
                    "91.58.200.176/28",
                    "91.58.200.192/26",
                    "91.58.201.0/24",
                    "91.58.202.0/23",
                    "91.58.204.0/22",
                    "91.58.208.0/20",
                    "91.58.224.0/19",
                    "91.59.0.0/16",
                    "91.60.0.0/14",
                    "91.103.240.0/24",
                    "91.103.243.0/24",
                    "91.103.244.0/22",
                    "91.124.6.0/23",
                    "91.124.26.0/23",
                    "91.124.28.0/24",
                    "91.124.34.0/24",
                    "91.189.192.0/21",
                    "91.194.232.0/23",
                    "91.198.82.0/24",
                    "91.198.197.0/24",
                    "91.199.21.0/24",
                    "91.200.253.0/24",
                    "91.206.188.0/24",
                    "91.207.92.0/23",
                    "91.207.118.0/24",
                    "91.208.13.0/24",
                    "91.208.18.0/24",
                    "91.208.38.0/24",
                    "91.209.159.0/24",
                    "91.212.243.0/24",
                    "91.213.116.0/24",
                    "91.214.10.0/24",
                    "91.216.45.0/24",
                    "91.216.242.0/24",
                    "91.217.214.0/24",
                    "91.222.232.0/22",
                    "91.232.54.0/24",
                    "92.112.69.0/24",
                    "92.112.141.0/24",
                    "92.112.158.0/24",
                    "92.119.164.0/22",
                    "92.119.208.0/22",
                    "93.113.70.0/24",
                    "93.119.201.0/24",
                    "93.192.0.0/12",
                    "93.208.0.0/13",
                    "93.216.0.0/16",
                    "93.217.0.0/17",
                    "93.217.128.0/18",
                    "93.217.192.0/20",
                    "93.217.208.0/21",
                    "93.217.216.0/22",
                    "93.217.220.0/25",
                    "93.217.220.128/28",
                    "93.217.220.144/29",
                    "93.217.220.152/30",
                    "93.217.220.156/31",
                    "93.217.220.159/32",
                    "93.217.220.160/27",
                    "93.217.220.192/26",
                    "93.217.221.0/24",
                    "93.217.222.0/23",
                    "93.217.224.0/19",
                    "93.218.0.0/15",
                    "93.220.0.0/14",
                    "93.224.0.0/11",
                    "94.26.64.0/23",
                    "94.126.98.0/24",
                    "109.72.116.0/24",
                    "109.237.176.0/20",
                    "128.65.164.0/22",
                    "129.181.208.0/21",
                    "129.181.216.0/22",
                    "137.170.112.0/24",
                    "139.12.1.0/24",
                    "139.12.2.0/23",
                    "139.12.4.0/24",
                    "139.12.127.0/24",
                    "139.12.251.0/24",
                    "139.12.253.0/24",
                    "139.12.255.0/24",
                    "140.233.208.0/20",
                    "141.77.0.0/16",
                    "141.169.240.0/20",
                    "143.99.213.0/24",
                    "145.225.16.0/23",
                    "147.79.8.0/21",
                    "147.204.2.0/24",
                    "149.51.0.0/21",
                    "149.51.96.0/21",
                    "149.208.250.0/23",
                    "149.208.252.0/23",
                    "149.233.64.0/18",
                    "149.237.201.0/24",
                    "149.237.203.0/24",
                    "149.237.250.0/23",
                    "149.237.254.0/24",
                    "149.243.232.0/22",
                    "149.249.244.0/22",
                    "151.243.168.0/24",
                    "151.243.173.0/24",
                    "153.96.22.0/24",
                    "153.96.218.0/24",
                    "153.97.32.0/24",
                    "153.97.34.0/24",
                    "154.6.104.0/22",
                    "154.6.132.0/22",
                    "154.6.248.0/22",
                    "154.91.148.0/22",
                    "163.5.47.0/24",
                    "163.5.66.0/24",
                    "163.5.156.0/24",
                    "163.5.220.0/24",
                    "164.133.10.0/23",
                    "164.133.91.0/24",
                    "164.133.150.0/24",
                    "168.199.128.0/22",
                    "168.199.160.0/22",
                    "168.199.192.0/22",
                    "168.199.212.0/22",
                    "170.237.92.0/23",
                    "172.82.74.0/24",
                    "176.53.136.0/23",
                    "176.57.59.0/24",
                    "178.23.188.0/24",
                    "185.10.120.0/23",
                    "185.21.247.0/24",
                    "185.39.12.0/22",
                    "185.48.0.0/22",
                    "185.57.24.0/24",
                    "185.97.227.0/24",
                    "185.100.160.0/22",
                    "185.101.244.0/22",
                    "185.157.101.0/24",
                    "185.161.176.0/22",
                    "185.163.76.0/22",
                    "185.180.224.0/24",
                    "185.183.212.0/22",
                    "185.188.64.0/24",
                    "185.195.239.0/24",
                    "185.198.13.0/24",
                    "185.202.32.0/21",
                    "185.207.46.0/24",
                    "185.237.0.0/23",
                    "185.237.2.0/24",
                    "185.242.224.0/24",
                    "185.243.44.0/22",
                    "186.190.214.0/24",
                    "186.190.222.0/24",
                    "188.208.124.0/23",
                    "188.209.223.0/24",
                    "188.214.136.0/24",
                    "188.214.139.0/24",
                    "192.31.102.0/24",
                    "192.54.39.0/24",
                    "192.54.48.0/24",
                    "192.54.73.0/24",
                    "192.54.79.0/24",
                    "192.67.63.0/24",
                    "192.67.167.0/24",
                    "192.88.4.0/24",
                    "192.109.54.0/24",
                    "192.109.96.0/24",
                    "192.109.124.0/24",
                    "192.109.129.0/24",
                    "192.109.130.0/24",
                    "192.109.150.0/23",
                    "192.109.152.0/24",
                    "192.109.154.0/23",
                    "192.109.156.0/23",
                    "192.109.158.0/24",
                    "192.109.209.0/24",
                    "192.145.8.0/23",
                    "192.145.10.0/24",
                    "193.0.63.0/24",
                    "193.3.240.0/24",
                    "193.16.235.0/24",
                    "193.22.16.0/22",
                    "193.22.29.0/24",
                    "193.22.110.0/24",
                    "193.22.164.0/24",
                    "193.22.174.0/24",
                    "193.22.205.0/24",
                    "193.24.7.0/24",
                    "193.24.72.0/21",
                    "193.25.208.0/23",
                    "193.26.124.0/24",
                    "193.28.15.0/24",
                    "193.28.34.0/23",
                    "193.28.48.0/23",
                    "193.28.50.0/24",
                    "193.28.207.0/24",
                    "193.28.240.0/23",
                    "193.29.112.0/24",
                    "193.29.115.0/24",
                    "193.29.116.0/24",
                    "193.29.126.0/24",
                    "193.30.136.0/22",
                    "193.30.192.0/19",
                    "193.31.1.0/24",
                    "193.31.128.0/19",
                    "193.37.148.0/24",
                    "193.39.200.0/23",
                    "193.41.10.0/23",
                    "193.47.164.0/24",
                    "193.53.93.0/24",
                    "193.58.253.0/24",
                    "193.84.136.0/22",
                    "193.96.230.0/24",
                    "193.96.232.0/23",
                    "193.97.238.0/24",
                    "193.98.181.0/24",
                    "193.98.224.0/24",
                    "193.99.96.0/20",
                    "193.100.1.0/24",
                    "193.100.2.0/23",
                    "193.100.244.0/22",
                    "193.100.248.0/22",
                    "193.100.252.0/24",
                    "193.101.13.0/24",
                    "193.101.14.0/23",
                    "193.101.57.0/24",
                    "193.101.68.0/24",
                    "193.101.128.0/22",
                    "193.101.139.0/24",
                    "193.101.162.0/23",
                    "193.102.136.0/24",
                    "193.102.153.0/24",
                    "193.102.167.0/24",
                    "193.102.179.0/24",
                    "193.103.165.0/24",
                    "193.104.90.0/24",
                    "193.105.68.0/24",
                    "193.106.140.0/22",
                    "193.110.102.0/23",
                    "193.138.91.0/24",
                    "193.141.91.0/24",
                    "193.141.143.0/24",
                    "193.141.180.0/23",
                    "193.143.24.0/22",
                    "193.158.0.0/15",
                    "193.163.15.0/24",
                    "193.168.0.0/24",
                    "193.168.232.0/22",
                    "193.169.204.0/23",
                    "193.186.31.0/24",
                    "193.188.196.0/24",
                    "193.201.170.0/24",
                    "193.201.206.0/24",
                    "193.219.105.0/24",
                    "193.254.21.0/24",
                    "193.254.22.0/24",
                    "193.254.128.0/19",
                    "193.254.160.0/20",
                    "194.0.151.0/24",
                    "194.0.232.0/24",
                    "194.15.60.0/23",
                    "194.15.64.0/21",
                    "194.15.72.0/22",
                    "194.15.194.0/24",
                    "194.25.0.0/16",
                    "194.31.65.0/24",
                    "194.31.142.0/24",
                    "194.31.210.0/23",
                    "194.31.225.0/24",
                    "194.33.50.0/24",
                    "194.33.115.0/24",
                    "194.33.120.0/23",
                    "194.38.49.0/24",
                    "194.38.51.0/24",
                    "194.39.48.0/20",
                    "194.39.88.0/21",
                    "194.39.97.0/24",
                    "194.39.175.0/24",
                    "194.39.189.0/24",
                    "194.49.48.0/24",
                    "194.49.54.0/24",
                    "194.49.73.0/24",
                    "194.49.74.0/23",
                    "194.49.85.0/24",
                    "194.49.117.0/24",
                    "194.49.118.0/23",
                    "194.55.87.0/24",
                    "194.55.180.0/24",
                    "194.55.183.0/24",
                    "194.55.192.0/19",
                    "194.59.3.0/24",
                    "194.59.58.0/24",
                    "194.69.128.0/21",
                    "194.69.136.0/22",
                    "194.69.140.0/23",
                    "194.69.142.0/24",
                    "194.76.30.0/23",
                    "194.76.45.0/24",
                    "194.76.48.0/22",
                    "194.76.52.0/24",
                    "194.76.110.0/23",
                    "194.76.142.0/24",
                    "194.76.144.0/24",
                    "194.76.174.0/23",
                    "194.76.176.0/21",
                    "194.76.209.0/24",
                    "194.76.212.0/22",
                    "194.77.41.0/24",
                    "194.77.42.0/24",
                    "194.88.16.0/21",
                    "194.88.24.0/23",
                    "194.88.26.0/24",
                    "194.88.28.0/23",
                    "194.99.92.0/22",
                    "194.110.133.0/24",
                    "194.113.20.0/23",
                    "194.113.60.0/24",
                    "194.113.93.0/24",
                    "194.113.160.0/22",
                    "194.115.1.0/24",
                    "194.115.52.0/24",
                    "194.115.66.0/24",
                    "194.115.88.0/23",
                    "194.115.90.0/24",
                    "194.115.92.0/22",
                    "194.115.120.0/24",
                    "194.115.163.0/24",
                    "194.115.182.0/24",
                    "194.120.22.0/23",
                    "194.120.109.0/24",
                    "194.120.110.0/23",
                    "194.120.170.0/24",
                    "194.120.249.0/24",
                    "194.121.46.0/24",
                    "194.121.62.0/23",
                    "194.121.90.0/24",
                    "194.121.172.0/22",
                    "194.127.107.0/24",
                    "194.127.120.0/23",
                    "194.127.134.0/24",
                    "194.127.168.0/23",
                    "194.127.176.0/24",
                    "194.127.182.0/24",
                    "194.127.195.0/24",
                    "194.127.242.0/23",
                    "194.127.254.0/24",
                    "194.147.171.0/24",
                    "194.150.228.0/23",
                    "194.152.128.0/23",
                    "194.152.132.0/24",
                    "194.152.141.0/24",
                    "194.152.154.0/23",
                    "194.153.86.0/24",
                    "194.156.128.0/22",
                    "194.156.148.0/24",
                    "194.156.186.0/23",
                    "194.156.196.0/23",
                    "194.176.121.0/24",
                    "194.180.21.0/24",
                    "194.180.54.0/24",
                    "194.180.114.0/24",
                    "194.180.152.0/23",
                    "194.180.175.0/24",
                    "194.180.190.0/24",
                    "194.180.210.0/23",
                    "194.180.212.0/22",
                    "194.180.234.0/23",
                    "195.36.90.0/23",
                    "195.66.83.0/24",
                    "195.68.204.0/23",
                    "195.78.249.0/24",
                    "195.78.251.0/24",
                    "195.133.7.0/24",
                    "195.137.216.0/23",
                    "195.138.223.0/24",
                    "195.144.15.0/24",
                    "195.145.0.0/16",
                    "195.160.248.0/22",
                    "195.190.2.0/24",
                    "195.192.254.0/24",
                    "195.200.207.0/24",
                    "195.226.200.0/24",
                    "195.230.116.0/24",
                    "195.234.133.0/24",
                    "195.248.89.0/24",
                    "195.248.128.0/22",
                    "195.248.132.0/24",
                    "195.248.140.0/23",
                    "195.248.144.0/23",
                    "195.250.50.0/24",
                    "195.250.57.0/24",
                    "196.44.120.0/22",
                    "196.44.125.0/24",
                    "196.44.127.0/24",
                    "198.40.80.0/24",
                    "198.40.90.0/24",
                    "198.57.10.0/24",
                    "199.119.136.0/24",
                    "204.52.112.0/20",
                    "204.242.64.0/20",
                    "204.242.192.0/20",
                    "212.68.172.0/22",
                    "212.68.176.0/21",
                    "212.184.0.0/15",
                    "213.145.90.0/23",
                    "213.145.92.0/23",
                    "213.173.0.0/19",
                    "213.209.136.0/24",
                    "213.209.149.0/24",
                    "213.209.156.0/24",
                    "213.232.252.0/24",
                    "217.0.0.0/13",
                    "217.80.0.0/15",
                    "217.82.0.0/16",
                    "217.83.0.0/20",
                    "217.83.16.0/26",
                    "217.83.16.64/27",
                    "217.83.16.96/28",
                    "217.83.16.112/29",
                    "217.83.16.120/30",
                    "217.83.16.124/31",
                    "217.83.16.127/32",
                    "217.83.16.128/25",
                    "217.83.17.0/24",
                    "217.83.18.0/23",
                    "217.83.20.0/22",
                    "217.83.24.0/21",
                    "217.83.32.0/19",
                    "217.83.64.0/18",
                    "217.83.128.0/17",
                    "217.84.0.0/14",
                    "217.88.0.0/13",
                    "217.117.96.0/24",
                    "217.177.33.0/24",
                    "217.224.0.0/14",
                    "217.228.0.0/16",
                    "217.229.0.0/17",
                    "217.229.128.0/20",
                    "217.229.144.0/24",
                    "217.229.145.0/26",
                    "217.229.145.64/28",
                    "217.229.145.80/30",
                    "217.229.145.84/32",
                    "217.229.145.86/31",
                    "217.229.145.88/29",
                    "217.229.145.96/27",
                    "217.229.145.128/25",
                    "217.229.146.0/23",
                    "217.229.148.0/22",
                    "217.229.152.0/25",
                    "217.229.152.128/27",
                    "217.229.152.160/29",
                    "217.229.152.168/31",
                    "217.229.152.170/32",
                    "217.229.152.172/30",
                    "217.229.152.176/28",
                    "217.229.152.192/26",
                    "217.229.153.0/24",
                    "217.229.154.0/23",
                    "217.229.156.0/22",
                    "217.229.160.0/19",
                    "217.229.192.0/18",
                    "217.230.0.0/15",
                    "217.232.0.0/13",
                    "217.240.0.0/12"
                ],
                ipv6: [
                    "2003:ec:2740::/42",
                    "2003:ec:2702:a400::/54",
                    "2003:ec:2600::/40",
                    "2003:ec:2702:a0e0::/59",
                    "2003:ec:2702:a0d1::/64",
                    "2003:ec:2702:a800::/53",
                    "2003:ec:2710::/44",
                    "2003:ec:2702:b000::/52",
                    "2003:ec:2702:a0c0::/60",
                    "2003:ec:2708::/45",
                    "2003:ec:2700::/47",
                    "2003:ec::/35",
                    "2003:ec:2704::/46",
                    "2003:ec:2702:8000::/51",
                    "2003:ec:2780::/41",
                    "2003:ec:2702:a200::/55",
                    "2003:ec:2702::/49",
                    "2003:ec:2702:a0d2::/63",
                    "2003:ec:3000::/36",
                    "2003:ec:4000::/34",
                    "2003:ec:2702:c000::/50",
                    "2003:ec:2720::/43",
                    "2003:ec:2702:a100::/56",
                    "2003:ec:2400::/39",
                    "2003:ec:2702:a0d8::/61",
                    "2003:ec:2000::/38",
                    "2003:ec:2702:a080::/58",
                    "2003:ec:2702:a000::/57",
                    "2003:ec:2800::/37",
                    "2003:ec:2703::/48",
                    "2003:ec:2702:a0d4::/62",
                    "2003:e1:2f80::/41",
                    "2003:c3:ff44::/49",
                    "2003:c6:574d:a502::/63",
                    "2a01:599:100::/42",
                    "2003:e1:2f0d:8000::/50",
                    "2003:ea:6f00::/46",
                    "2003:e1:2f20::/43",
                    "2003:e1:2f0d:c000::/51",
                    "2a01:599:148:2c00::/55",
                    "2003:ee:370d:401::/64",
                    "2a01:599:148:2000::/53",
                    "2003:c6:574d:a400::/56",
                    "2003:c6:5400::/39",
                    "2003:c3:8000::/34",
                    "2003:ee:3780::/41",
                    "2a01:599:140::/45",
                    "2003:c6:574d:a600::/55",
                    "2a01:599:148:2f00::/56",
                    "2003:e1::/35",
                    "2003:e1:2f40::/42",
                    "2003:e1:3000::/36",
                    "2003:ea:6f08::/45",
                    "2003:e1:2e00::/40",
                    "2003:ea:6f20::/43",
                    "2003:c3:ff44:9000::/54",
                    "2003:ea:6f06:7940::/60",
                    "2003:c6:5748::/46",
                    "2a01:599:148:2ec0::/64",
                    "2003:c6:574c::/48",
                    "2003:c6:574d:a500::/64",
                    "2a01:599:148:4000::/50",
                    "2003:c6:574d:a510::/60",
                    "2003:e1:2f0d:f000::/52",
                    "2003:c6:574d:8000::/51",
                    "2003:e1:2f0d:e000::/54",
                    "2003:ee:370d:480::/57",
                    "2003:c3:ff44:9600::/55",
                    "2003:c3:ff44:a000::/51",
                    "2003:e1:2f08::/46",
                    "2003:e1:2f0d:e608::/61",
                    "2003:c6:574d:a800::/53",
                    "2a01:599:148:2ed0::/60",
                    "2003:e1:2f0e::/47",
                    "2003:c6:574d:a540::/58",
                    "2a01:599:160::/43",
                    "2003:ea:6f06:7958::/62",
                    "2003:e1:2f0d:e620::/59",
                    "2a01:599:148:2e80::/58",
                    "2003:c6:574e::/47",
                    "2003:ea:6f06:7960::/59",
                    "2003:e1:2c00::/39",
                    "2003:e0::/32",
                    "2003:c2::/32",
                    "2003:ea:6f06:4000::/51",
                    "2003:c3::/33",
                    "2003:c3:ff44:8000::/52",
                    "2003:ea:6f06:7800::/56",
                    "2003:e1:2f0d:e680::/57",
                    "2a01:599:200::/39",
                    "2003:ee:3700::/45",
                    "2003:c6:574d:a504::/62",
                    "2003:c6:574d:c000::/50",
                    "2003:ea:6e00::/40",
                    "2003:c3:ff60::/43",
                    "2003:e1:2f0d:e800::/53",
                    "2003:c6:6000::/35",
                    "2003:ea:6f06:795e::/64",
                    "2003:ee:370c::/48",
                    "2003:ee:3000::/38",
                    "2a01:599:148:2800::/54",
                    "2003:ea:6f06:7950::/61",
                    "2003:ea:6f06:795c::/63",
                    "2003:ea:8000::/33",
                    "2003:e1:2f0d:e610::/60",
                    "2003:ee:370d::/54",
                    "2003:c6:574d:b000::/52",
                    "2003:c3:ff50::/44",
                    "2003:ee:3720::/43",
                    "2003:c6:5760::/43",
                    "2003:e1:2f0d:e400::/55",
                    "2003:c3:ff44:9510::/60",
                    "2003:ee:3800::/37",
                    "2a01:599:148:2ec2::/63",
                    "2003:e1:2f0d:e640::/58",
                    "2a01:599::/40",
                    "2003:e1:2f0d:e602::/63",
                    "2003:c3:f000::/37",
                    "2003:ea:6f40::/42",
                    "2003:ea:6f06:7a00::/55",
                    "2003:ea:6f06:7c00::/54",
                    "2003:c7::/32",
                    "2003:ea:6f06:7000::/53",
                    "2003:c6:5000::/38",
                    "2003:c3:ff80::/41",
                    "2a01:599:148:8000::/49",
                    "2003:ee:370d:8000::/49",
                    "2003:ee:370d:800::/53",
                    "2a01:599:148::/51",
                    "2a01:599:149::/48",
                    "2003:ee:3600::/40",
                    "2a01:599:150::/44",
                    "2a01:599:148:2ec8::/61",
                    "2003:c3:ff48::/45",
                    "2003:ee:370d:600::/55",
                    "2003:ea:6000::/37",
                    "2003:e1:2f0d:e601::/64",
                    "2003:ee:370d:402::/63",
                    "2003:ea:6f06:6000::/52",
                    "2003:c3:ff44:9508::/61",
                    "2003:ea:6c00::/39",
                    "2003:ee:370d:2000::/51",
                    "2003:ee:370d:404::/62",
                    "2003:e1:8000::/33",
                    "2003:c6:5700::/42",
                    "2003:e1:2f0c::/48",
                    "2003:ee:2000::/36",
                    "2003:e1:4000::/34",
                    "2003:e1:2f10::/44",
                    "2003:ee:370d:408::/61",
                    "2003:c6:5600::/40",
                    "2003:c3:ff44:9504::/62",
                    "2003:c3:f800::/38",
                    "2003:c6:5740::/45",
                    "2003:e2::/31",
                    "2003:c3:ff44:9400::/56",
                    "2003:c6:5780::/41",
                    "2003:ea::/34",
                    "2003:ee:3710::/44",
                    "2003:ea:6f07::/48",
                    "2003:c3:ff44:9501::/64",
                    "2003:ee:370d:1000::/52",
                    "2003:c3:ff44:9520::/59",
                    "2003:c3:fe00::/40",
                    "2003:c6:5800::/37",
                    "2003:e1:2f00::/45",
                    "2003:c3:ff44:c000::/50",
                    "2003:c3:ff00::/42",
                    "2003:c3:ff44:9502::/63",
                    "2003:c6:4000::/36",
                    "2a01:599:400::/38",
                    "2003:ea:6f06:8000::/49",
                    "2a01:599:148:2ec4::/62",
                    "2a01:599:14c::/46",
                    "2003:c3:c000::/35",
                    "2a01:599:180::/41",
                    "2003:ee:3400::/39",
                    "2003:ea:6f06:7900::/58",
                    "2003:c3:fc00::/39",
                    "2003:ee:370e::/47",
                    "2003:c6:574d:a580::/57",
                    "2003:ee:3708::/46",
                    "2003:c3:ff45::/48",
                    "2003:e1:2f0d:e700::/56",
                    "2003:ea:6f06::/50",
                    "2a01:599:14a::/47",
                    "2003:c3:ff44:9800::/53",
                    "2003:ee:370d:410::/60",
                    "2003:ee:370d:420::/59",
                    "2003:e1:2800::/38",
                    "2003:ea:6f04::/47",
                    "2003:c3:e000::/36",
                    "2003:ea:6f06:7980::/57",
                    "2003:c6:574d:a000::/54",
                    "2003:c3:ff40::/46",
                    "2003:c6:574d::/49",
                    "2003:e1:2000::/37",
                    "2003:c3:ff44:9580::/57",
                    "2003:c4::/31",
                    "2003:c6:5750::/44",
                    "2a01:599:148:2ee0::/59",
                    "2003:ee:370d:500::/56",
                    "2003:ee:370d:440::/58",
                    "2003:e1:2f0d::/49",
                    "2003:ea:6800::/38",
                    "2003:ea:6f80::/41",
                    "2a01:599:148:2e00::/57",
                    "2003:c6:8000::/33",
                    "2003:ee:3740::/42",
                    "2003:c6:574d:a508::/61",
                    "2003:c3:ff46::/47",
                    "2003:e1:2f0d:e604::/62",
                    "2a01:599:148:3000::/52",
                    "2003:ea:4000::/35",
                    "2003:ee:370d:4000::/50",
                    "2003:ea:6f10::/44",
                    "2003:eb::/32",
                    "2003:c3:ff44:9540::/58",
                    "2003:c6:574d:a520::/59",
                    "2003:ea:7f05:a08::/61",
                    "2003:ea:7f05:a10::/60",
                    "2003:ea:7f20::/43",
                    "2003:ea:7f40::/42",
                    "2003:ea:7f05:a04::/62",
                    "2003:ea:7f05:a01::/64",
                    "2003:ea:7f05:a40::/58",
                    "2003:ea:7f00::/46",
                    "2003:ea:7e00::/40",
                    "2003:ea:7f10::/44",
                    "2003:ea:7000::/37",
                    "2003:ea:7c00::/39",
                    "2003:ea:7800::/38",
                    "2003:ea:7f05:4000::/50",
                    "2003:ea:7f05:b00::/56",
                    "2003:ea:7f06::/47",
                    "2003:ea:7f05:c00::/54",
                    "2003:ea:7f05:8000::/49",
                    "2003:ea:7f05::/53",
                    "2003:ea:7f05:a20::/59",
                    "2003:ea:7f05:2000::/51",
                    "2003:ea:7f08::/45",
                    "2003:ea:7f05:1000::/52",
                    "2003:ea:7f05:a80::/57",
                    "2003:ea:7f80::/41",
                    "2003:ea:7f05:800::/55",
                    "2003:ea:7f05:a02::/63",
                    "2003:ea:7f04::/48",
                    "2003:c6:2f3b::/50",
                    "2003:c6:2f3b:6000::/51",
                    "2003:c6:2f3b:5340::/58",
                    "2003:c6::/35",
                    "2003:c6:2000::/37",
                    "2003:c6:2f00::/43",
                    "2003:c6:2f3b:5800::/53",
                    "2003:c6:2c00::/39",
                    "2003:c6:2f3b:5400::/54",
                    "2003:c6:2f40::/42",
                    "2003:c6:2f3c::/46",
                    "2003:c6:2f3b:5200::/56",
                    "2003:c6:2f3b:5302::/63",
                    "2003:c6:2f38::/47",
                    "2003:c6:2800::/38",
                    "2003:c6:2f3b:5304::/62",
                    "2003:c6:2f3b:5310::/60",
                    "2003:c6:2f80::/41",
                    "2003:c6:2f30::/45",
                    "2003:c6:2f3b:5320::/59",
                    "2003:c6:2f3b:5308::/61",
                    "2003:c6:2f3b:5000::/55",
                    "2003:c6:3000::/36",
                    "2003:c6:2f3b:5380::/57",
                    "2003:c6:2f3a::/48",
                    "2003:c6:2f3b:8000::/49",
                    "2003:c6:2f3b:5301::/64",
                    "2003:c6:2f20::/44",
                    "2003:c6:2f3b:4000::/52",
                    "2003:c6:2e00::/40",
                    "2001:650:cc02::/48",
                    "2001:678:36c::/48",
                    "2001:678:480::/48",
                    "2001:678:5b0::/48",
                    "2001:678:5d4::/48",
                    "2001:678:a04::/48",
                    "2001:678:adc::/48",
                    "2001:678:bdc::/48",
                    "2001:678:d4c::/48",
                    "2001:678:ff0::/48",
                    "2001:67c:5cc::/48",
                    "2001:67c:94c::/48",
                    "2001:67c:b80::/48",
                    "2001:67c:c84::/48",
                    "2001:67c:c9c::/48",
                    "2001:67c:ec0::/48",
                    "2001:67c:11a4::/48",
                    "2001:67c:227c::/48",
                    "2001:67c:22d4::/48",
                    "2001:67c:2b30::/48",
                    "2001:67c:2d88::/48",
                    "2001:67c:2e28::/48",
                    "2003::/25",
                    "2003:80::/26",
                    "2003:c0::/33",
                    "2003:c0:8000::/35",
                    "2003:c0:a000::/37",
                    "2003:c0:a800::/38",
                    "2003:c0:ac00::/39",
                    "2003:c0:ae00::/40",
                    "2003:c0:af00::/44",
                    "2003:c0:af10::/46",
                    "2003:c0:af14::/49",
                    "2003:c0:af14:8000::/50",
                    "2003:c0:af14:c000::/51",
                    "2003:c0:af14:e000::/56",
                    "2003:c0:af14:e101::/64",
                    "2003:c0:af14:e102::/63",
                    "2003:c0:af14:e104::/62",
                    "2003:c0:af14:e108::/61",
                    "2003:c0:af14:e110::/60",
                    "2003:c0:af14:e120::/59",
                    "2003:c0:af14:e140::/58",
                    "2003:c0:af14:e180::/57",
                    "2003:c0:af14:e200::/55",
                    "2003:c0:af14:e400::/54",
                    "2003:c0:af14:e800::/53",
                    "2003:c0:af14:f000::/52",
                    "2003:c0:af15::/48",
                    "2003:c0:af16::/47",
                    "2003:c0:af18::/45",
                    "2003:c0:af20::/43",
                    "2003:c0:af40::/42",
                    "2003:c0:af80::/41",
                    "2003:c0:b000::/36",
                    "2003:c0:c000::/34",
                    "2003:c1::/32",
                    "2003:c8::/32",
                    "2003:c9::/33",
                    "2003:c9:8000::/34",
                    "2003:c9:c000::/35",
                    "2003:c9:e000::/36",
                    "2003:c9:f000::/38",
                    "2003:c9:f400::/39",
                    "2003:c9:f600::/40",
                    "2003:c9:f700::/42",
                    "2003:c9:f740::/48",
                    "2003:c9:f741::/49",
                    "2003:c9:f741:8000::/50",
                    "2003:c9:f741:c000::/53",
                    "2003:c9:f741:c800::/54",
                    "2003:c9:f741:cc00::/55",
                    "2003:c9:f741:ce00::/56",
                    "2003:c9:f741:cf00::/59",
                    "2003:c9:f741:cf20::/61",
                    "2003:c9:f741:cf28::/62",
                    "2003:c9:f741:cf2d::/64",
                    "2003:c9:f741:cf2e::/63",
                    "2003:c9:f741:cf30::/60",
                    "2003:c9:f741:cf40::/58",
                    "2003:c9:f741:cf80::/57",
                    "2003:c9:f741:d000::/52",
                    "2003:c9:f741:e000::/51",
                    "2003:c9:f742::/47",
                    "2003:c9:f744::/46",
                    "2003:c9:f748::/45",
                    "2003:c9:f750::/44",
                    "2003:c9:f760::/43",
                    "2003:c9:f780::/41",
                    "2003:c9:f800::/37",
                    "2003:ca::/31",
                    "2003:cc::/30",
                    "2003:d0::/29",
                    "2003:d8::/30",
                    "2003:dc::/32",
                    "2003:dd::/33",
                    "2003:dd:8000::/35",
                    "2003:dd:a000::/36",
                    "2003:dd:b000::/38",
                    "2003:dd:b400::/39",
                    "2003:dd:b600::/40",
                    "2003:dd:b700::/46",
                    "2003:dd:b704::/47",
                    "2003:dd:b706::/49",
                    "2003:dd:b706:8000::/50",
                    "2003:dd:b706:c000::/51",
                    "2003:dd:b706:e000::/52",
                    "2003:dd:b706:f000::/54",
                    "2003:dd:b706:f400::/56",
                    "2003:dd:b706:f501::/64",
                    "2003:dd:b706:f502::/63",
                    "2003:dd:b706:f504::/62",
                    "2003:dd:b706:f508::/61",
                    "2003:dd:b706:f510::/60",
                    "2003:dd:b706:f520::/59",
                    "2003:dd:b706:f540::/58",
                    "2003:dd:b706:f580::/57",
                    "2003:dd:b706:f600::/55",
                    "2003:dd:b706:f800::/53",
                    "2003:dd:b707::/48",
                    "2003:dd:b708::/45",
                    "2003:dd:b710::/44",
                    "2003:dd:b720::/43",
                    "2003:dd:b740::/42",
                    "2003:dd:b780::/41",
                    "2003:dd:b800::/37",
                    "2003:dd:c000::/34",
                    "2003:de::/31",
                    "2003:e4::/33",
                    "2003:e4:8000::/35",
                    "2003:e4:a000::/38",
                    "2003:e4:a400::/39",
                    "2003:e4:a600::/40",
                    "2003:e4:a700::/43",
                    "2003:e4:a720::/44",
                    "2003:e4:a730::/45",
                    "2003:e4:a738::/47",
                    "2003:e4:a73a::/51",
                    "2003:e4:a73a:2000::/52",
                    "2003:e4:a73a:3000::/61",
                    "2003:e4:a73a:3008::/62",
                    "2003:e4:a73a:300c::/64",
                    "2003:e4:a73a:300e::/63",
                    "2003:e4:a73a:3010::/60",
                    "2003:e4:a73a:3020::/59",
                    "2003:e4:a73a:3040::/58",
                    "2003:e4:a73a:3080::/57",
                    "2003:e4:a73a:3100::/56",
                    "2003:e4:a73a:3200::/55",
                    "2003:e4:a73a:3400::/54",
                    "2003:e4:a73a:3800::/53",
                    "2003:e4:a73a:4000::/50",
                    "2003:e4:a73a:8000::/49",
                    "2003:e4:a73b::/48",
                    "2003:e4:a73c::/46",
                    "2003:e4:a740::/42",
                    "2003:e4:a780::/41",
                    "2003:e4:a800::/37",
                    "2003:e4:b000::/36",
                    "2003:e4:c000::/34",
                    "2003:e5::/35",
                    "2003:e5:2000::/36",
                    "2003:e5:3000::/37",
                    "2003:e5:3800::/38",
                    "2003:e5:3c00::/39",
                    "2003:e5:3e00::/40",
                    "2003:e5:3f00::/43",
                    "2003:e5:3f20::/44",
                    "2003:e5:3f30::/46",
                    "2003:e5:3f34::/47",
                    "2003:e5:3f36::/48",
                    "2003:e5:3f37::/50",
                    "2003:e5:3f37:4000::/52",
                    "2003:e5:3f37:5000::/53",
                    "2003:e5:3f37:5800::/54",
                    "2003:e5:3f37:5c00::/56",
                    "2003:e5:3f37:5d01::/64",
                    "2003:e5:3f37:5d02::/63",
                    "2003:e5:3f37:5d04::/62",
                    "2003:e5:3f37:5d08::/61",
                    "2003:e5:3f37:5d10::/60",
                    "2003:e5:3f37:5d20::/59",
                    "2003:e5:3f37:5d40::/58",
                    "2003:e5:3f37:5d80::/57",
                    "2003:e5:3f37:5e00::/55",
                    "2003:e5:3f37:6000::/51",
                    "2003:e5:3f37:8000::/49",
                    "2003:e5:3f38::/45",
                    "2003:e5:3f40::/42",
                    "2003:e5:3f80::/41",
                    "2003:e5:4000::/34",
                    "2003:e5:8000::/35",
                    "2003:e5:a000::/36",
                    "2003:e5:b000::/38",
                    "2003:e5:b400::/39",
                    "2003:e5:b600::/40",
                    "2003:e5:b700::/46",
                    "2003:e5:b704::/47",
                    "2003:e5:b706::/50",
                    "2003:e5:b706:4000::/52",
                    "2003:e5:b706:5000::/53",
                    "2003:e5:b706:5800::/55",
                    "2003:e5:b706:5a00::/57",
                    "2003:e5:b706:5a80::/58",
                    "2003:e5:b706:5ac0::/59",
                    "2003:e5:b706:5ae0::/60",
                    "2003:e5:b706:5af0::/61",
                    "2003:e5:b706:5af8::/62",
                    "2003:e5:b706:5afc::/63",
                    "2003:e5:b706:5aff::/64",
                    "2003:e5:b706:5b00::/56",
                    "2003:e5:b706:5c00::/54",
                    "2003:e5:b706:6000::/51",
                    "2003:e5:b706:8000::/49",
                    "2003:e5:b707::/48",
                    "2003:e5:b708::/45",
                    "2003:e5:b710::/44",
                    "2003:e5:b720::/43",
                    "2003:e5:b740::/42",
                    "2003:e5:b780::/41",
                    "2003:e5:b800::/37",
                    "2003:e5:c000::/34",
                    "2003:e6::/31",
                    "2003:e8::/37",
                    "2003:e8:800::/38",
                    "2003:e8:c00::/39",
                    "2003:e8:e00::/40",
                    "2003:e8:f00::/45",
                    "2003:e8:f08::/46",
                    "2003:e8:f0c::/48",
                    "2003:e8:f0d::/50",
                    "2003:e8:f0d:4000::/53",
                    "2003:e8:f0d:4800::/54",
                    "2003:e8:f0d:4c00::/56",
                    "2003:e8:f0d:4d01::/64",
                    "2003:e8:f0d:4d02::/63",
                    "2003:e8:f0d:4d04::/62",
                    "2003:e8:f0d:4d08::/61",
                    "2003:e8:f0d:4d10::/60",
                    "2003:e8:f0d:4d20::/59",
                    "2003:e8:f0d:4d40::/58",
                    "2003:e8:f0d:4d80::/57",
                    "2003:e8:f0d:4e00::/55",
                    "2003:e8:f0d:5000::/52",
                    "2003:e8:f0d:6000::/51",
                    "2003:e8:f0d:8000::/49",
                    "2003:e8:f0e::/47",
                    "2003:e8:f10::/44",
                    "2003:e8:f20::/43",
                    "2003:e8:f40::/42",
                    "2003:e8:f80::/41",
                    "2003:e8:1000::/36",
                    "2003:e8:2000::/35",
                    "2003:e8:4000::/34",
                    "2003:e8:8000::/33",
                    "2003:e9::/32",
                    "2003:ec:8000::/37",
                    "2003:ec:8800::/38",
                    "2003:ec:8c00::/39",
                    "2003:ec:8e00::/40",
                    "2003:ec:8f00::/43",
                    "2003:ec:8f20::/44",
                    "2003:ec:8f30::/49",
                    "2003:ec:8f30:8000::/51",
                    "2003:ec:8f30:a000::/52",
                    "2003:ec:8f30:b000::/56",
                    "2003:ec:8f30:b101::/64",
                    "2003:ec:8f30:b102::/63",
                    "2003:ec:8f30:b104::/62",
                    "2003:ec:8f30:b108::/61",
                    "2003:ec:8f30:b110::/60",
                    "2003:ec:8f30:b120::/59",
                    "2003:ec:8f30:b140::/58",
                    "2003:ec:8f30:b180::/57",
                    "2003:ec:8f30:b200::/55",
                    "2003:ec:8f30:b400::/54",
                    "2003:ec:8f30:b800::/53",
                    "2003:ec:8f30:c000::/50",
                    "2003:ec:8f31::/48",
                    "2003:ec:8f32::/47",
                    "2003:ec:8f34::/46",
                    "2003:ec:8f38::/45",
                    "2003:ec:8f40::/42",
                    "2003:ec:8f80::/41",
                    "2003:ec:9000::/36",
                    "2003:ec:a000::/35",
                    "2003:ec:c000::/34",
                    "2003:ed::/32",
                    "2003:ee::/37",
                    "2003:ee:800::/38",
                    "2003:ee:c00::/39",
                    "2003:ee:e00::/40",
                    "2003:ee:f00::/48",
                    "2003:ee:f01::/50",
                    "2003:ee:f01:4000::/51",
                    "2003:ee:f01:6000::/52",
                    "2003:ee:f01:7000::/54",
                    "2003:ee:f01:7401::/64",
                    "2003:ee:f01:7402::/63",
                    "2003:ee:f01:7404::/62",
                    "2003:ee:f01:7408::/61",
                    "2003:ee:f01:7410::/60",
                    "2003:ee:f01:7420::/59",
                    "2003:ee:f01:7440::/58",
                    "2003:ee:f01:7480::/57",
                    "2003:ee:f01:7500::/56",
                    "2003:ee:f01:7600::/55",
                    "2003:ee:f01:7800::/53",
                    "2003:ee:f01:8000::/49",
                    "2003:ee:f02::/47",
                    "2003:ee:f04::/46",
                    "2003:ee:f08::/45",
                    "2003:ee:f10::/44",
                    "2003:ee:f20::/43",
                    "2003:ee:f40::/42",
                    "2003:ee:f80::/41",
                    "2003:ee:1000::/36",
                    "2003:ee:4000::/34",
                    "2003:ee:8000::/33",
                    "2003:ef::/32",
                    "2003:f0::/30",
                    "2003:f4::/31",
                    "2003:f6::/38",
                    "2003:f6:400::/39",
                    "2003:f6:600::/40",
                    "2003:f6:700::/44",
                    "2003:f6:710::/46",
                    "2003:f6:714::/48",
                    "2003:f6:715::/49",
                    "2003:f6:715:8000::/53",
                    "2003:f6:715:8800::/56",
                    "2003:f6:715:8901::/64",
                    "2003:f6:715:8902::/63",
                    "2003:f6:715:8904::/62",
                    "2003:f6:715:8908::/61",
                    "2003:f6:715:8910::/60",
                    "2003:f6:715:8920::/59",
                    "2003:f6:715:8940::/58",
                    "2003:f6:715:8980::/57",
                    "2003:f6:715:8a00::/55",
                    "2003:f6:715:8c00::/54",
                    "2003:f6:715:9000::/52",
                    "2003:f6:715:a000::/51",
                    "2003:f6:715:c000::/50",
                    "2003:f6:716::/47",
                    "2003:f6:718::/45",
                    "2003:f6:720::/43",
                    "2003:f6:740::/42",
                    "2003:f6:780::/41",
                    "2003:f6:800::/37",
                    "2003:f6:1000::/36",
                    "2003:f6:2000::/35",
                    "2003:f6:4000::/34",
                    "2003:f6:8000::/33",
                    "2003:f7::/32",
                    "2003:f8::/31",
                    "2003:fa::/32",
                    "2003:fb::/33",
                    "2003:fb:8000::/34",
                    "2003:fb:c000::/35",
                    "2003:fb:e000::/37",
                    "2003:fb:e800::/38",
                    "2003:fb:ec00::/39",
                    "2003:fb:ee00::/40",
                    "2003:fb:ef00::/46",
                    "2003:fb:ef04::/48",
                    "2003:fb:ef05::/50",
                    "2003:fb:ef05:4000::/51",
                    "2003:fb:ef05:6000::/56",
                    "2003:fb:ef05:6101::/64",
                    "2003:fb:ef05:6102::/63",
                    "2003:fb:ef05:6104::/62",
                    "2003:fb:ef05:6108::/61",
                    "2003:fb:ef05:6110::/60",
                    "2003:fb:ef05:6120::/59",
                    "2003:fb:ef05:6140::/58",
                    "2003:fb:ef05:6180::/57",
                    "2003:fb:ef05:6200::/55",
                    "2003:fb:ef05:6400::/54",
                    "2003:fb:ef05:6800::/53",
                    "2003:fb:ef05:7000::/52",
                    "2003:fb:ef05:8000::/49",
                    "2003:fb:ef06::/47",
                    "2003:fb:ef08::/45",
                    "2003:fb:ef10::/44",
                    "2003:fb:ef20::/43",
                    "2003:fb:ef40::/42",
                    "2003:fb:ef80::/41",
                    "2003:fb:f000::/36",
                    "2003:fc::/30",
                    "2003:100::/24",
                    "2003:200::/23",
                    "2003:400::/22",
                    "2003:800::/21",
                    "2003:1000::/20",
                    "2602:fd92:c60::/44",
                    "2a00:5c60:3::/48",
                    "2a00:5c60:a::/48",
                    "2a00:6680::/46",
                    "2a01:598::/32",
                    "2a01:599:800::/39",
                    "2a01:599:a00::/44",
                    "2a01:599:a10::/46",
                    "2a01:599:a14::/47",
                    "2a01:599:a16::/50",
                    "2a01:599:a16:4000::/51",
                    "2a01:599:a16:6000::/53",
                    "2a01:599:a16:6800::/58",
                    "2a01:599:a16:6840::/59",
                    "2a01:599:a16:6860::/61",
                    "2a01:599:a16:6868::/62",
                    "2a01:599:a16:686c::/63",
                    "2a01:599:a16:686f::/64",
                    "2a01:599:a16:6870::/60",
                    "2a01:599:a16:6880::/57",
                    "2a01:599:a16:6900::/56",
                    "2a01:599:a16:6a00::/55",
                    "2a01:599:a16:6c00::/54",
                    "2a01:599:a16:7000::/52",
                    "2a01:599:a16:8000::/49",
                    "2a01:599:a17::/48",
                    "2a01:599:a18::/45",
                    "2a01:599:a20::/43",
                    "2a01:599:a40::/42",
                    "2a01:599:a80::/41",
                    "2a01:599:b00::/40",
                    "2a01:599:c00::/38",
                    "2a01:599:1000::/36",
                    "2a01:599:2000::/35",
                    "2a01:599:4000::/34",
                    "2a01:599:8000::/33",
                    "2a01:59a::/31",
                    "2a01:59c::/30",
                    "2a03:1e80:c000::/40",
                    "2a03:5ee0::/32",
                    "2a09:6f80::/29",
                    "2a09:8180::/30",
                    "2a0a:5340:ffff::/48",
                    "2a0b:3c41:2::/48",
                    "2a0c:9e02:100::/40",
                    "2a0c:9e02:200::/39",
                    "2a0c:9e02:400::/38",
                    "2a0c:9e02:800::/39",
                    "2a0c:9e02:1000::/40",
                    "2a0e:cbc4::/30",
                    "2a0e:eb40::/32",
                    "2a10:cd80::/29",
                    "2a11:7400:d1::/48",
                    "2a12:6900:1000::/40"
                ]
            }
        };

        // تابع کمکی: تبدیل آرایه بایت به Base64
        function toBase64(buffer) {
            let binary = '';
            let bytes = new Uint8Array(buffer);
            for (let i = 0; i < bytes.byteLength; i++) {
                binary += String.fromCharCode(bytes[i]);
            }
            return btoa(binary);
        }

        // تولید کلیدهای وایرگارد و ذخیره در متغیر سراسری
        document.getElementById('genKeys').addEventListener('click', function () {
            const keyPair = nacl.box.keyPair();
            generatedKeys = {
                privateKey: toBase64(keyPair.secretKey),
                publicKey: toBase64(keyPair.publicKey)
            };
            document.getElementById('keysDisplay').innerHTML = `
                <p><strong>Private Key:</strong> ${generatedKeys.privateKey}</p>
                <p><strong>Public Key:</strong> ${generatedKeys.publicKey}</p>
            `;
        });

        // اطمینان از اینکه فقط یک نوع Endpoint انتخاب شود
        document.getElementById('endpointIPv4Check').addEventListener('change', function () {
            if (this.checked) {
                document.getElementById('endpointIPv6Check').checked = false;
            }
        });
        document.getElementById('endpointIPv6Check').addEventListener('change', function () {
            if (this.checked) {
                document.getElementById('endpointIPv4Check').checked = false;
            }
        });

        // توابع تولید آدرس/دینس تصادفی (فقط برای DNS)
        function randomIP(cidr) {
            let [base, mask] = cidr.split('/');
            mask = parseInt(mask);
            let baseParts = base.split('.').map(Number);
            let ipInt = (baseParts[0] << 24) | (baseParts[1] << 16) | (baseParts[2] << 8) | baseParts[3];
            let hostBits = 32 - mask;
            let max = Math.pow(2, hostBits);
            let rand = Math.floor(Math.random() * max);
            let newIP = ipInt + rand;
            return [
                (newIP >> 24) & 255,
                (newIP >> 16) & 255,
                (newIP >> 8) & 255,
                newIP & 255
            ].join('.');
        }
        function expandIPv6(address) {
            if (address.indexOf("::") === -1) return address;
            let parts = address.split("::");
            let left = parts[0].split(':').filter(Boolean);
            let right = parts[1].split(':').filter(Boolean);
            let missing = 8 - (left.length + right.length);
            let zeros = Array(missing).fill("0");
            return left.concat(zeros).concat(right).join(':');
        }
        function randomIPv6(cidr) {
            let [base, prefixLength] = cidr.split('/');
            prefixLength = parseInt(prefixLength);
            let expanded = expandIPv6(base);
            let groups = expanded.split(':');
            let networkGroups = Math.floor(prefixLength / 16);
            let result = groups.slice(0, networkGroups);
            let remaining = 8 - networkGroups;
            for (let i = 0; i < remaining; i++) {
                result.push(Math.floor(Math.random() * 0x10000).toString(16));
            }
            return result.join(':');
        }

        // ایجاد کاندیدای پیش‌نمایش ساده (بدون نیاز به چک‌باکس)
        function createSimpleCandidateElement(candidateText, onConfirm, onCancel) {
            const container = document.createElement('div');
            container.className = 'candidate-item';
            container.innerHTML = `
                <span class="candidate-text">${candidateText}</span>
                <div class="candidate-actions">
                    <button class="confirmCandidateBtn">افزودن</button>
                    <button class="cancelCandidateBtn">انصراف</button>
                </div>
            `;
            container.querySelector('.confirmCandidateBtn').addEventListener('click', function () {
                onConfirm(candidateText);
                container.remove();
            });
            container.querySelector('.cancelCandidateBtn').addEventListener('click', function () {
                if (onCancel) onCancel();
                container.remove();
            });
            return container;
        }

        // ایجاد آیتم لیست با قابلیت حذف
        function createListItem(text) {
            const item = document.createElement('div');
            item.className = 'list-item';
            const span = document.createElement('span');
            span.textContent = text;
            const delBtn = document.createElement('button');
            delBtn.textContent = "×";
            delBtn.addEventListener('click', function () {
                item.remove();
            });
            item.appendChild(span);
            item.appendChild(delBtn);
            return item;
        }

        // رویدادهای پیش‌نمایش برای آدرس‌ها (برای Address، فقط رنج کپی شود)
        document.getElementById('previewAddressIPv4').addEventListener('click', function () {
            const locKey = document.getElementById('location').value;
            const loc = locations[locKey];
            // انتخاب تصادفی یک رنج از ipv4
            const randomIndex = Math.floor(Math.random() * loc.ipv4.length);
            const candidate = loc.ipv4[randomIndex];
            const candidateElem = createSimpleCandidateElement(candidate, function (text) {
                document.getElementById('addressList').appendChild(createListItem(text));
            });
            const container = document.getElementById('addressCandidate');
            container.innerHTML = '';
            container.appendChild(candidateElem);
        });
        document.getElementById('previewAddressIPv6').addEventListener('click', function () {
            const locKey = document.getElementById('location').value;
            const loc = locations[locKey];
            // انتخاب تصادفی یک رنج از ipv6
            const randomIndex = Math.floor(Math.random() * loc.ipv6.length);
            const candidate = loc.ipv6[randomIndex];
            const candidateElem = createSimpleCandidateElement(candidate, function (text) {
                document.getElementById('addressList').appendChild(createListItem(text));
            });
            const container = document.getElementById('addressCandidate');
            container.innerHTML = '';
            container.appendChild(candidateElem);
        });

        // رویدادهای پیش‌نمایش برای DNS (برای DNS، تولید آدرس تصادفی انجام می‌شود)
        document.getElementById('previewDNSIPv4').addEventListener('click', function () {
            const locKey = document.getElementById('location').value;
            const loc = locations[locKey];
            // انتخاب تصادفی یک رنج از ipv4 برای تولید DNS
            const randomIndex = Math.floor(Math.random() * loc.ipv4.length);
            const candidate = randomIP(loc.ipv4[randomIndex]);
            const candidateElem = createSimpleCandidateElement(candidate, function (text) {
                document.getElementById('dnsList').appendChild(createListItem(text));
            });
            const container = document.getElementById('dnsCandidate');
            container.innerHTML = '';
            container.appendChild(candidateElem);
        });
        document.getElementById('previewDNSIPv6').addEventListener('click', function () {
            const locKey = document.getElementById('location').value;
            const loc = locations[locKey];
            // انتخاب تصادفی یک رنج از ipv6 برای تولید DNS
            const randomIndex = Math.floor(Math.random() * loc.ipv6.length);
            const candidate = randomIPv6(loc.ipv6[randomIndex]);
            const candidateElem = createSimpleCandidateElement(candidate, function (text) {
                document.getElementById('dnsList').appendChild(createListItem(text));
            });
            const container = document.getElementById('dnsCandidate');
            container.innerHTML = '';
            container.appendChild(candidateElem);
        });

        // استفاده از event delegation برای آدرس‌های پیشفرض (برای کارایی بالا)
        document.getElementById('defaultAddressesContainer').addEventListener('change', function (e) {
            if (e.target && e.target.matches('input[type="checkbox"]')) {
                const checkbox = e.target;
                const listId = "list-item-" + checkbox.id;
                const existingItem = document.getElementById(listId);
                if (checkbox.checked) {
                    const item = createListItem(checkbox.value);
                    item.id = listId;
                    document.getElementById('addressList').appendChild(item);
                } else {
                    if (existingItem) {
                        existingItem.remove();
                    }
                }
            }
        });

        // تولید کانفیگ نهایی
        document.getElementById('generateConfig').addEventListener('click', function () {
            // بررسی اینکه کلیدهای وایرگارد تولید شده باشند
            if (!generatedKeys) {
                alert("لطفاً ابتدا کلیدهای وایرگارد را تولید کنید.");
                return;
            }

            const locKey = document.getElementById('location').value;
            const loc = locations[locKey];
            const port = document.getElementById('port').value;
            let privateKey = generatedKeys.privateKey;
            // گردآوری آدرس‌ها (فقط مقادیر لیست آدرس‌ها)
            let addresses = [];
            document.querySelectorAll('#addressList .list-item span').forEach(span => {
                addresses.push(span.textContent);
            });
            const customAddr = document.getElementById('customAddress').value;
            if (customAddr) {
                addresses.push(customAddr);
            }

            // گردآوری DNS (از لیست آیتم‌های DNS)
            let dnsList = [];
            document.querySelectorAll('#dnsList .list-item span').forEach(span => {
                dnsList.push(span.textContent);
            });
            const customDNS = document.getElementById('customDNS').value;
            if (customDNS) {
                dnsList.push(customDNS);
            }

            // تعیین Endpoint بر اساس انتخاب نوع Endpoint (فقط یکی انتخاب شده)
            let endpoint = "";
            if (document.getElementById('endpointIPv4Check').checked) {
                const randomIndex = Math.floor(Math.random() * loc.ipv4.length);
                endpoint = randomIP(loc.ipv4[randomIndex]) + ":" + port;
            } else if (document.getElementById('endpointIPv6Check').checked) {
                const randomIndex = Math.floor(Math.random() * loc.ipv6.length);
                endpoint = "[" + randomIPv6(loc.ipv6[randomIndex]) + "]:" + port;
            }

            // اضافه کردن MTU و PersistentKeepalive در صورت وارد کردن توسط کاربر
            let mtu = document.getElementById('mtu').value.trim();
            let keepalive = document.getElementById('keepalive').value.trim();

            let interfaceSection = `[Interface]
    PrivateKey = ${privateKey}
    Address = ${addresses.join(", ")}
    DNS = ${dnsList.join(", ")}`;
            if (mtu !== "") {
                interfaceSection += `
    MTU = ${mtu}`;
            }

            let peerSection = `[Peer]
    PublicKey = ${generatedKeys.publicKey}
    AllowedIPs = ${document.getElementById('allowedIPs').value}
    Endpoint = ${endpoint}`;
            if (keepalive !== "") {
                peerSection += `
    PersistentKeepalive = ${keepalive}`;
            }

            let config = interfaceSection + "\n\n" + peerSection;
            document.getElementById('configOutput').value = config;
        });

        // دانلود مستقیم کانفیگ
        document.getElementById('downloadConfig').addEventListener('click', function () {
            const configText = document.getElementById('configOutput').value;
            const blob = new Blob([configText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'wg-config.conf';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        });

        // دانلود کانفیگ به صورت Zip
        document.getElementById('downloadZip').addEventListener('click', function () {
            const configText = document.getElementById('configOutput').value;
            const zipFilename = document.getElementById('zipFilename').value || 'wg-config';
            var zip = new JSZip();
            zip.file("wg-config.conf", configText);
            zip.generateAsync({ type: "blob" }).then(function (content) {
                const url = URL.createObjectURL(content);
                const a = document.createElement('a');
                a.href = url;
                a.download = zipFilename + '.zip';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            });
        });
    </script>

</body>

</html>
